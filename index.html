<!DOCTYPE html>  <html> <head>   <title>driftwood.js</title>   <meta http-equiv="content-type" content="text/html; charset=UTF-8">   <link rel="stylesheet" media="all" href="docco.css" /> </head> <body>   <div id="container">     <div id="background"></div>          <table cellpadding="0" cellspacing="0">       <thead>         <tr>           <th class="docs">             <h1>               driftwood.js             </h1>           </th>           <th class="code">           </th>         </tr>       </thead>       <tbody>                               <tr id="section-1">             <td class="docs">               <div class="pilwrap">                 <a class="pilcrow" href="#section-1">&#182;</a>               </div>               <p><strong>Driftwood.js</strong> is a super simple logging and exception tracking library for client side javascript. Works in all major browsers.</p>

<p><a href="https://github.com/errplane/driftwood.js">Driftwood on Github</a></p>

<p>Matthew Kanwisher <a href="http://errplane.com">Errplane Inc</a> <br />
MIT License
Copyright 2012 Errplane</p>             </td>             <td class="code">               <div class="highlight"><pre></pre></div>             </td>           </tr>                               <tr id="section-2">             <td class="docs">               <div class="pilwrap">                 <a class="pilcrow" href="#section-2">&#182;</a>               </div>               <p>Driftwood namespace is a static namespace for logging, if you want instances of loggers do:</p>

<pre><code>  var logger = new Driftwood.logger();
</code></pre>             </td>             <td class="code">               <div class="highlight"><pre><span class="kd">var</span> <span class="nx">Driftwood</span> <span class="o">=</span> <span class="k">new</span> <span class="kd">function</span><span class="p">()</span> <span class="p">{</span>

  <span class="k">this</span><span class="p">.</span><span class="nx">logger</span>  <span class="o">=</span> <span class="kd">function</span><span class="p">()</span> <span class="p">{</span>
	  <span class="kd">var</span> <span class="nx">levels</span> <span class="o">=</span> <span class="p">[</span><span class="s2">&quot;DEBUG&quot;</span><span class="p">,</span> <span class="s2">&quot;INFO&quot;</span><span class="p">,</span> <span class="s2">&quot;ERROR&quot;</span><span class="p">,</span> <span class="s2">&quot;EXCEPTION&quot;</span><span class="p">,</span> <span class="s2">&quot;NONE&quot;</span><span class="p">]</span></pre></div>             </td>           </tr>                               <tr id="section-3">             <td class="docs">               <div class="pilwrap">                 <a class="pilcrow" href="#section-3">&#182;</a>               </div>               <p>Don't change the config directly. Instead use the helper methods below.</p>             </td>             <td class="code">               <div class="highlight"><pre>  	<span class="kd">var</span> <span class="nx">config</span> <span class="o">=</span>  <span class="p">{</span> 
	  		<span class="nx">consoleLevel</span><span class="o">:</span> <span class="s2">&quot;DEBUG&quot;</span><span class="p">,</span> <span class="c1">//This get changed if you change the environment</span>
	  		<span class="nx">consoleLevelId</span><span class="o">:</span> <span class="mi">0</span><span class="p">,</span>
	  		<span class="nx">exceptionLevel</span><span class="o">:</span> <span class="s2">&quot;NONE&quot;</span><span class="p">,</span> <span class="c1">//In dev you probably don&#39;t want to transmit exceptions to the server</span>
	  		<span class="nx">exceptionLevelId</span><span class="o">:</span> <span class="mi">99</span><span class="p">,</span>
	  		<span class="nx">mode</span><span class="o">:</span> <span class="s2">&quot;development&quot;</span><span class="p">,</span> <span class="c1">//This should either be development  or production</span>
	  		<span class="nx">serverPath</span><span class="o">:</span> <span class="s2">&quot;/exceptions/notify?payload=&quot;</span><span class="p">,</span>
	  		<span class="nx">applicationName</span><span class="o">:</span> <span class="s2">&quot;js_client&quot;</span> <span class="c1">// this should be overriden by the user</span>
	  	<span class="p">};</span>
  	<span class="kd">var</span> <span class="nx">findLevel</span> <span class="o">=</span> <span class="kd">function</span><span class="p">(</span><span class="nx">level</span><span class="p">)</span> <span class="p">{</span>
  		 <span class="k">return</span> <span class="nx">levels</span><span class="p">.</span><span class="nx">indexOf</span><span class="p">(</span><span class="nx">level</span><span class="p">.</span><span class="nx">toUpperCase</span><span class="p">());</span>
  	<span class="p">};</span>
  	<span class="k">return</span> <span class="p">{</span></pre></div>             </td>           </tr>                               <tr id="section-4">             <td class="docs">               <div class="pilwrap">                 <a class="pilcrow" href="#section-4">&#182;</a>               </div>               <p>Creates a notification URL
Currently were not validating that urls are under 2048 charecters, so this could cause problems in IE.
Will fix this in next rev
While this function is technically supposed to be private, we still expose it so you can modify it.</p>             </td>             <td class="code">               <div class="highlight"><pre>		  <span class="nx">_genExceptionUrl</span><span class="o">:</span> <span class="kd">function</span><span class="p">(</span><span class="nx">error</span><span class="p">)</span> <span class="p">{</span>
		    <span class="kd">var</span> <span class="nx">url</span> <span class="o">=</span> <span class="nx">config</span><span class="p">.</span><span class="nx">serverPath</span> <span class="o">+</span> <span class="nb">encodeURIComponent</span><span class="p">(</span><span class="nx">JSON</span><span class="p">.</span><span class="nx">stringify</span><span class="p">(</span><span class="nx">error</span><span class="p">));</span>
		    <span class="k">return</span> <span class="nx">url</span><span class="p">;</span>
		  <span class="p">},</span></pre></div>             </td>           </tr>                               <tr id="section-5">             <td class="docs">               <div class="pilwrap">                 <a class="pilcrow" href="#section-5">&#182;</a>               </div>               <p>Generates the script tag, you could replace this implementation with one that loads images instead</p>             </td>             <td class="code">               <div class="highlight"><pre>		  <span class="nx">_genScriptTag</span><span class="o">:</span> <span class="kd">function</span><span class="p">(</span><span class="nx">src</span><span class="p">)</span> <span class="p">{</span>
 		    <span class="kd">var</span> <span class="nx">script</span> <span class="o">=</span> <span class="nb">document</span><span class="p">.</span><span class="nx">createElement</span><span class="p">(</span><span class="s2">&quot;script&quot;</span><span class="p">);</span>
		    <span class="nx">script</span><span class="p">.</span><span class="nx">src</span> <span class="o">=</span> <span class="nx">src</span><span class="p">;</span>
		    <span class="nb">document</span><span class="p">.</span><span class="nx">body</span><span class="p">.</span><span class="nx">appendChild</span><span class="p">(</span><span class="nx">script</span><span class="p">);</span>
			<span class="p">},</span></pre></div>             </td>           </tr>                               <tr id="section-6">             <td class="docs">               <div class="pilwrap">                 <a class="pilcrow" href="#section-6">&#182;</a>               </div>               <p>While this function is technically supposed to be private, we still expose it so you can modify it.</p>             </td>             <td class="code">               <div class="highlight"><pre>	  	<span class="nx">_createBlackBox</span><span class="o">:</span> <span class="kd">function</span><span class="p">(</span><span class="nx">error</span><span class="p">)</span> <span class="p">{</span>
			 <span class="kd">var</span> <span class="nx">blackBox</span> <span class="o">=</span>	<span class="p">{</span>
		      <span class="s2">&quot;application_name&quot;</span><span class="o">:</span> <span class="nx">config</span><span class="p">.</span><span class="nx">applicationName</span><span class="p">,</span>
		      <span class="s2">&quot;message&quot;</span><span class="o">:</span> <span class="nx">error</span> <span class="o">||</span> <span class="s2">&quot;&quot;</span><span class="p">,</span>
		      </pre></div>             </td>           </tr>                               <tr id="section-7">             <td class="docs">               <div class="pilwrap">                 <a class="pilcrow" href="#section-7">&#182;</a>               </div>               <p>Request</p>             </td>             <td class="code">               <div class="highlight"><pre>		      <span class="s2">&quot;url&quot;</span><span class="o">:</span> <span class="nb">window</span><span class="p">.</span><span class="nx">location</span><span class="p">.</span><span class="nx">toString</span><span class="p">(),</span>
		      <span class="s2">&quot;language&quot;</span><span class="o">:</span><span class="s2">&quot;javascript&quot;</span><span class="p">,</span>
		      <span class="s2">&quot;custom_data&quot;</span><span class="o">:</span> <span class="p">{</span> 
			      <span class="s2">&quot;hostname&quot;</span><span class="o">:</span> <span class="nb">window</span><span class="p">.</span><span class="nx">location</span><span class="p">.</span><span class="nx">hostname</span><span class="p">,</span>
			      <span class="s2">&quot;user_agent&quot;</span><span class="o">:</span> <span class="nx">navigator</span><span class="p">.</span><span class="nx">userAgent</span> <span class="o">||</span> <span class="s2">&quot;&quot;</span><span class="p">,</span>
			      <span class="s2">&quot;referrer&quot;</span><span class="o">:</span> <span class="nb">document</span><span class="p">.</span><span class="nx">referrer</span> <span class="o">||</span> <span class="s2">&quot;&quot;</span><span class="p">,</span>
			      <span class="s2">&quot;cookies&quot;</span><span class="o">:</span> <span class="nb">document</span><span class="p">.</span><span class="nx">cookie</span> <span class="o">||</span> <span class="s2">&quot;&quot;</span><span class="p">,</span>
			    <span class="p">},</span>
		      <span class="s2">&quot;backtrace&quot;</span><span class="o">:</span> <span class="k">this</span><span class="p">.</span><span class="nx">getBackTrace</span><span class="p">(</span><span class="nx">error</span><span class="p">),</span>
		      <span class="s2">&quot;exception_class&quot;</span><span class="o">:</span> <span class="s2">&quot;Javscript#Unknown&quot;</span> <span class="c1">//TODO figure out what the class should be</span>
		    <span class="p">}</span>
	  		<span class="k">return</span> <span class="nx">blackBox</span><span class="p">;</span>
	  	<span class="p">},</span></pre></div>             </td>           </tr>                               <tr id="section-8">             <td class="docs">               <div class="pilwrap">                 <a class="pilcrow" href="#section-8">&#182;</a>               </div>               <p>Its safe to use this function with external servers since we do everything on the query string</p>             </td>             <td class="code">               <div class="highlight"><pre>  		<span class="nx">url</span><span class="o">:</span> <span class="kd">function</span><span class="p">(</span><span class="nx">murl</span><span class="p">)</span> <span class="p">{</span>
  			<span class="nx">config</span><span class="p">.</span><span class="nx">serverPath</span> <span class="o">=</span> <span class="nx">murl</span><span class="p">;</span> 
  		<span class="p">},</span>
	  	<span class="nx">env</span><span class="o">:</span> <span class="kd">function</span><span class="p">(</span><span class="nx">menv</span><span class="p">)</span> <span class="p">{</span>
	  		<span class="k">if</span><span class="p">(</span><span class="nx">menv</span><span class="p">.</span><span class="nx">toLowerCase</span><span class="p">()</span> <span class="o">==</span> <span class="s2">&quot;development&quot;</span><span class="p">)</span> <span class="p">{</span>
	  			<span class="nx">config</span><span class="p">.</span><span class="nx">consoleLevel</span> <span class="o">=</span> <span class="s2">&quot;DEBUG&quot;</span><span class="p">;</span>
	  			<span class="nx">config</span><span class="p">.</span><span class="nx">exceptionLevel</span> <span class="o">=</span> <span class="s2">&quot;none&quot;</span><span class="p">;</span>
	  			<span class="nx">config</span><span class="p">.</span><span class="nx">consoleLevelId</span> <span class="o">=</span> <span class="mi">0</span><span class="p">;</span>
	  			<span class="nx">config</span><span class="p">.</span><span class="nx">exceptionLevelId</span> <span class="o">=</span> <span class="mi">4</span><span class="p">;</span>
	  		<span class="p">}</span> <span class="k">else</span> <span class="k">if</span><span class="p">(</span><span class="nx">menv</span><span class="p">.</span><span class="nx">toLowerCase</span><span class="p">()</span> <span class="o">==</span> <span class="s2">&quot;production&quot;</span><span class="p">)</span> <span class="p">{</span>
	  			<span class="nx">config</span><span class="p">.</span><span class="nx">consoleLevel</span> <span class="o">=</span> <span class="s2">&quot;ERROR&quot;</span><span class="p">;</span>
	  			<span class="nx">config</span><span class="p">.</span><span class="nx">exceptionLevel</span> <span class="o">=</span> <span class="s2">&quot;none&quot;</span><span class="p">;</span>
	  			<span class="nx">config</span><span class="p">.</span><span class="nx">consoleLevelId</span> <span class="o">=</span> <span class="mi">2</span><span class="p">;</span>
	  			<span class="nx">config</span><span class="p">.</span><span class="nx">exceptionLevelId</span> <span class="o">=</span> <span class="mi">3</span><span class="p">;</span>
	  		<span class="p">}</span> <span class="k">else</span> <span class="p">{</span>
	  			<span class="nx">console</span><span class="p">.</span><span class="nx">log</span><span class="p">(</span><span class="s2">&quot;Unknown environment level&quot;</span><span class="p">);</span>
	  		<span class="p">}</span>
	  	<span class="p">},</span>
	  	<span class="nx">applicationName</span><span class="o">:</span> <span class="kd">function</span><span class="p">(</span><span class="nx">appname</span><span class="p">)</span> <span class="p">{</span>
	  		<span class="nx">config</span><span class="p">.</span><span class="nx">applicationName</span> <span class="o">=</span> <span class="nx">appname</span><span class="p">;</span>
	  	<span class="p">},</span>
	  	<span class="nx">logLevel</span><span class="o">:</span> <span class="kd">function</span><span class="p">(</span><span class="nx">level</span><span class="p">)</span> <span class="p">{</span>
	  		<span class="kd">var</span> <span class="nx">id</span> <span class="o">=</span> <span class="nx">findLevel</span><span class="p">(</span><span class="nx">level</span><span class="p">);</span>
	  		<span class="k">if</span><span class="p">(</span> <span class="nx">id</span> <span class="o">&gt;</span> <span class="o">-</span><span class="mi">1</span> <span class="p">)</span> <span class="p">{</span>
		  		<span class="nx">config</span><span class="p">.</span><span class="nx">consoleLevel</span> <span class="o">=</span> <span class="nx">level</span><span class="p">.</span><span class="nx">toUpperCase</span><span class="p">();</span>
		  		<span class="nx">config</span><span class="p">.</span><span class="nx">consoleLevelId</span> <span class="o">=</span> <span class="nx">id</span><span class="p">;</span>
		  	<span class="p">}</span> <span class="k">else</span> <span class="p">{</span>
		  		<span class="nx">console</span><span class="p">.</span><span class="nx">log</span><span class="p">(</span><span class="s2">&quot;Setting an invalid log level: &quot;</span> <span class="o">+</span> <span class="nx">level</span><span class="p">);</span>
		  	<span class="p">}</span>
	  	<span class="p">},</span>
	  	<span class="nx">exceptionLevel</span><span class="o">:</span> <span class="kd">function</span><span class="p">(</span><span class="nx">level</span><span class="p">)</span> <span class="p">{</span>
	  		<span class="kd">var</span> <span class="nx">id</span> <span class="o">=</span> <span class="nx">findLevel</span><span class="p">(</span><span class="nx">level</span><span class="p">);</span>
	  		<span class="k">if</span><span class="p">(</span> <span class="nx">id</span> <span class="o">&gt;</span> <span class="o">-</span><span class="mi">1</span> <span class="p">)</span> <span class="p">{</span>
		  		<span class="nx">config</span><span class="p">.</span><span class="nx">exceptionLevel</span> <span class="o">=</span> <span class="nx">level</span><span class="p">.</span><span class="nx">toUpperCase</span><span class="p">();</span>
		  		<span class="nx">config</span><span class="p">.</span><span class="nx">exceptionLevelId</span> <span class="o">=</span> <span class="nx">id</span><span class="p">;</span>
		  	<span class="p">}</span> <span class="k">else</span> <span class="p">{</span>
		  		<span class="nx">console</span><span class="p">.</span><span class="nx">log</span><span class="p">(</span><span class="s2">&quot;Setting an invalid log level: &quot;</span> <span class="o">+</span> <span class="nx">level</span><span class="p">);</span>
		  	<span class="p">}</span>
	  	<span class="p">},</span></pre></div>             </td>           </tr>                               <tr id="section-9">             <td class="docs">               <div class="pilwrap">                 <a class="pilcrow" href="#section-9">&#182;</a>               </div>               <p>The actually function that sends the data to the server</p>             </td>             <td class="code">               <div class="highlight"><pre>			<span class="nx">transmit</span><span class="o">:</span> <span class="kd">function</span><span class="p">(</span><span class="nx">message</span><span class="p">,</span> <span class="nx">additionalData</span><span class="p">)</span> <span class="p">{</span>
			  <span class="kd">var</span> <span class="nx">e</span> <span class="o">=</span> <span class="kc">null</span><span class="p">;</span>
			  <span class="k">if</span> <span class="p">(</span><span class="k">typeof</span> <span class="nx">message</span> <span class="o">===</span> <span class="s2">&quot;object&quot;</span><span class="p">)</span> <span class="p">{</span>
			    <span class="nx">e</span> <span class="o">=</span> <span class="nx">message</span><span class="p">;</span>
			    <span class="nx">message</span> <span class="o">=</span> <span class="nx">e</span><span class="p">.</span><span class="nx">message</span><span class="p">;</span>
			  <span class="p">}</span>
			  
			  <span class="kd">var</span> <span class="nx">error</span> <span class="o">=</span> <span class="k">this</span><span class="p">.</span><span class="nx">_createBlackBox</span><span class="p">(</span><span class="nx">message</span><span class="p">,</span> <span class="nx">additionalData</span><span class="p">);</span>		  
		    <span class="kd">var</span> <span class="nx">src</span> <span class="o">=</span> <span class="k">this</span><span class="p">.</span><span class="nx">_genExceptionUrl</span><span class="p">(</span><span class="nx">error</span><span class="p">);</span>
		    <span class="k">this</span><span class="p">.</span><span class="nx">_genScriptTag</span><span class="p">(</span><span class="nx">src</span><span class="p">);</span>
			<span class="p">},</span>
  		<span class="nx">log</span><span class="o">:</span> <span class="kd">function</span><span class="p">(</span><span class="nx">message</span><span class="p">,</span> <span class="nx">level</span><span class="p">)</span> <span class="p">{</span>
  			<span class="kd">var</span> <span class="nx">levelId</span> <span class="o">=</span> <span class="nx">findLevel</span><span class="p">(</span><span class="nx">level</span><span class="p">);</span>
				<span class="kd">var</span> <span class="nx">d</span><span class="o">=</span><span class="k">new</span> <span class="nb">Date</span><span class="p">();</span>

  			<span class="k">if</span><span class="p">(</span> <span class="nx">levelId</span> <span class="o">&gt;=</span> <span class="nx">config</span><span class="p">.</span><span class="nx">consoleLevelId</span> <span class="p">)</span> <span class="p">{</span>
  				<span class="nx">console</span><span class="p">.</span><span class="nx">log</span><span class="p">(</span> <span class="nx">level</span> <span class="o">+</span> <span class="s2">&quot;:&quot;</span> <span class="o">+</span> <span class="s2">&quot;[&quot;</span>  <span class="o">+</span> <span class="nx">ISODateString</span><span class="p">(</span><span class="nx">d</span><span class="p">)</span> <span class="o">+</span> <span class="s2">&quot;] &quot;</span>  <span class="o">+</span> <span class="nx">message</span> <span class="p">);</span>
  			<span class="p">}</span> 
  			<span class="k">if</span><span class="p">(</span> <span class="nx">levelId</span> <span class="o">&gt;=</span> <span class="nx">config</span><span class="p">.</span><span class="nx">exceptionLevelId</span><span class="p">)</span> <span class="p">{</span>
  				<span class="k">this</span><span class="p">.</span><span class="nx">transmit</span><span class="p">(</span><span class="nx">message</span><span class="p">);</span>
  			<span class="p">}</span>
  		<span class="p">},</span>
	  	<span class="nx">debug</span><span class="o">:</span> <span class="kd">function</span><span class="p">(</span><span class="nx">message</span><span class="p">)</span> <span class="p">{</span>
	  		<span class="k">this</span><span class="p">.</span><span class="nx">log</span><span class="p">(</span><span class="nx">message</span><span class="p">,</span> <span class="s2">&quot;DEBUG&quot;</span><span class="p">);</span>
  		<span class="p">},</span>
	  	<span class="nx">info</span><span class="o">:</span> <span class="kd">function</span><span class="p">(</span><span class="nx">message</span><span class="p">)</span> <span class="p">{</span>
	  		<span class="k">this</span><span class="p">.</span><span class="nx">log</span><span class="p">(</span><span class="nx">message</span><span class="p">,</span> <span class="s2">&quot;INFO&quot;</span><span class="p">)</span>
  		<span class="p">},</span>
	  	<span class="nx">error</span><span class="o">:</span> <span class="kd">function</span><span class="p">(</span><span class="nx">message</span><span class="p">)</span> <span class="p">{</span>
	  		<span class="k">this</span><span class="p">.</span><span class="nx">log</span><span class="p">(</span><span class="nx">message</span><span class="p">,</span> <span class="s2">&quot;ERROR&quot;</span><span class="p">);</span>
  		<span class="p">},</span>
  		<span class="nx">exception</span><span class="o">:</span> <span class="kd">function</span><span class="p">(</span><span class="nx">message</span><span class="p">,</span><span class="nx">extraInfo</span><span class="p">)</span> <span class="p">{</span>
  			<span class="k">this</span><span class="p">.</span><span class="nx">log</span><span class="p">(</span><span class="nx">message</span><span class="p">,</span> <span class="s2">&quot;EXCEPTION&quot;</span><span class="p">,</span><span class="nx">extraInfo</span><span class="p">);</span>
  		<span class="p">},</span></pre></div>             </td>           </tr>                               <tr id="section-10">             <td class="docs">               <div class="pilwrap">                 <a class="pilcrow" href="#section-10">&#182;</a>               </div>               <p>You can pass an exception or string to this function</p>             </td>             <td class="code">               <div class="highlight"><pre>		  <span class="nx">getBackTrace</span><span class="o">:</span> <span class="kd">function</span><span class="p">(</span><span class="nx">message</span><span class="p">,</span> <span class="nx">url</span><span class="p">,</span> <span class="nx">line</span><span class="p">)</span> <span class="p">{</span>
		    <span class="kd">var</span> <span class="nx">backTrace</span> <span class="o">=</span> <span class="p">[</span><span class="s2">&quot;no backtrace&quot;</span><span class="p">];</span>
		    <span class="k">if</span> <span class="p">(</span><span class="k">typeof</span> <span class="nx">message</span> <span class="o">===</span> <span class="s2">&quot;object&quot;</span><span class="p">)</span> <span class="p">{</span>
		      <span class="nx">backTrace</span> <span class="o">=</span> <span class="nx">printStackTrace</span><span class="p">({</span><span class="s2">&quot;e&quot;</span><span class="o">:</span> <span class="nx">message</span><span class="p">});</span>
		    <span class="p">}</span> <span class="k">else</span> <span class="p">{</span>
		      <span class="nx">backTrace</span> <span class="o">=</span> <span class="nx">printStackTrace</span><span class="p">();</span>
		    <span class="p">}</span>
		    <span class="k">return</span> <span class="nx">backTrace</span><span class="p">;</span>
		  <span class="p">}</span>

  	<span class="p">}</span>
  <span class="p">};</span>		

  <span class="nx">defaultLogger</span> <span class="o">=</span> <span class="k">new</span> <span class="k">this</span><span class="p">.</span><span class="nx">logger</span><span class="p">();</span>
  <span class="k">this</span><span class="p">.</span><span class="nx">exception</span> <span class="o">=</span> <span class="kd">function</span><span class="p">(</span><span class="nx">message</span><span class="p">,</span><span class="nx">extraInfo</span><span class="p">)</span> <span class="p">{</span>
  	<span class="nx">defaultLogger</span><span class="p">.</span><span class="nx">exception</span><span class="p">(</span><span class="nx">message</span><span class="p">,</span><span class="nx">extraInfo</span><span class="p">);</span>
  <span class="p">}</span>  
  <span class="k">this</span><span class="p">.</span><span class="nx">applicationName</span> <span class="o">=</span> <span class="kd">function</span><span class="p">(</span><span class="nx">appname</span><span class="p">){</span>
  	<span class="nx">defaultLogger</span><span class="p">.</span><span class="nx">applicationName</span><span class="p">(</span><span class="nx">appname</span><span class="p">);</span>
  <span class="p">}</span></pre></div>             </td>           </tr>                               <tr id="section-11">             <td class="docs">               <div class="pilwrap">                 <a class="pilcrow" href="#section-11">&#182;</a>               </div>               <p>Convience methods around the logger to have a static instance</p>             </td>             <td class="code">               <div class="highlight"><pre>  <span class="k">this</span><span class="p">.</span><span class="nx">debug</span> <span class="o">=</span> <span class="kd">function</span><span class="p">(</span><span class="nx">message</span><span class="p">)</span> <span class="p">{</span>
  	<span class="nx">defaultLogger</span><span class="p">.</span><span class="nx">debug</span><span class="p">(</span><span class="nx">message</span><span class="p">);</span>
  <span class="p">};</span>
  <span class="k">this</span><span class="p">.</span><span class="nx">info</span> <span class="o">=</span> <span class="kd">function</span><span class="p">(</span><span class="nx">message</span><span class="p">)</span> <span class="p">{</span>
  	<span class="nx">defaultLogger</span><span class="p">.</span><span class="nx">info</span><span class="p">(</span><span class="nx">message</span><span class="p">);</span>
  <span class="p">};</span>
  <span class="k">this</span><span class="p">.</span><span class="nx">error</span> <span class="o">=</span> <span class="kd">function</span><span class="p">(</span><span class="nx">message</span><span class="p">)</span> <span class="p">{</span>
  	<span class="nx">defaultLogger</span><span class="p">.</span><span class="nx">error</span><span class="p">(</span><span class="nx">message</span><span class="p">);</span>
  <span class="p">};</span>

  <span class="k">this</span><span class="p">.</span><span class="nx">env</span> <span class="o">=</span> <span class="kd">function</span><span class="p">(</span><span class="nx">mode</span><span class="p">)</span> <span class="p">{</span>
  	<span class="nx">defaultLogger</span><span class="p">.</span><span class="nx">env</span><span class="p">(</span><span class="nx">mode</span><span class="p">);</span>
  <span class="p">};</span>

 <span class="k">this</span><span class="p">.</span><span class="nx">exceptionLevel</span> <span class="o">=</span>  <span class="kd">function</span><span class="p">(</span><span class="nx">level</span><span class="p">)</span> <span class="p">{</span>
 	<span class="nx">defaultLogger</span><span class="p">.</span><span class="nx">exceptionLevel</span><span class="p">(</span><span class="nx">mode</span><span class="p">);</span>
  <span class="p">};</span>

 <span class="k">this</span><span class="p">.</span><span class="nx">logLevel</span> <span class="o">=</span>  <span class="kd">function</span><span class="p">(</span><span class="nx">level</span><span class="p">)</span> <span class="p">{</span>
 	<span class="nx">defaultLogger</span><span class="p">.</span><span class="nx">logLevel</span><span class="p">(</span><span class="nx">mode</span><span class="p">);</span>
  <span class="p">};</span>

<span class="p">};</span></pre></div>             </td>           </tr>                               <tr id="section-12">             <td class="docs">               <div class="pilwrap">                 <a class="pilcrow" href="#section-12">&#182;</a>               </div>               <p>Global error handler</p>             </td>             <td class="code">               <div class="highlight"><pre><span class="nb">window</span><span class="p">.</span><span class="nx">onerror</span> <span class="o">=</span> <span class="kd">function</span><span class="p">(</span><span class="nx">message</span><span class="p">,</span> <span class="nx">url</span><span class="p">,</span> <span class="nx">line</span><span class="p">)</span> <span class="p">{</span>
  <span class="nx">Driftwood</span><span class="p">.</span><span class="nx">exception</span><span class="p">(</span><span class="nx">message</span><span class="p">,</span> <span class="p">{</span><span class="s2">&quot;url&quot;</span><span class="o">:</span> <span class="nx">url</span><span class="p">,</span> <span class="s2">&quot;line&quot;</span><span class="o">:</span> <span class="nx">line</span><span class="p">});</span>
<span class="p">};</span></pre></div>             </td>           </tr>                               <tr id="section-13">             <td class="docs">               <div class="pilwrap">                 <a class="pilcrow" href="#section-13">&#182;</a>               </div>               <p>Mozilla implementation of Array.indexOf, for IE &lt; 9
See http://stackoverflow.com/questions/143847/best-way-to-find-an-item-in-a-javascript-array</p>             </td>             <td class="code">               <div class="highlight"><pre><span class="k">if</span><span class="p">(</span><span class="o">!</span><span class="nb">Array</span><span class="p">.</span><span class="nx">prototype</span><span class="p">.</span><span class="nx">indexOf</span><span class="p">){</span><span class="nb">Array</span><span class="p">.</span><span class="nx">prototype</span><span class="p">.</span><span class="nx">indexOf</span><span class="o">=</span><span class="kd">function</span><span class="p">(</span><span class="nx">searchElement</span><span class="p">){</span><span class="s2">&quot;use strict&quot;</span><span class="p">;</span><span class="k">if</span><span class="p">(</span><span class="k">this</span><span class="o">===</span><span class="k">void</span> <span class="mi">0</span><span class="o">||</span><span class="k">this</span><span class="o">===</span><span class="kc">null</span><span class="p">)</span><span class="k">throw</span> <span class="k">new</span> <span class="nx">TypeError</span><span class="p">();</span><span class="kd">var</span> <span class="nx">t</span><span class="o">=</span><span class="nb">Object</span><span class="p">(</span><span class="k">this</span><span class="p">);</span><span class="kd">var</span> <span class="nx">len</span><span class="o">=</span><span class="nx">t</span><span class="p">.</span><span class="nx">length</span><span class="o">&gt;&gt;&gt;</span><span class="mi">0</span><span class="p">;</span><span class="k">if</span><span class="p">(</span><span class="nx">len</span><span class="o">===</span><span class="mi">0</span><span class="p">)</span><span class="k">return</span><span class="o">-</span><span class="mi">1</span><span class="p">;</span><span class="kd">var</span> <span class="nx">n</span><span class="o">=</span><span class="mi">0</span><span class="p">;</span><span class="k">if</span><span class="p">(</span><span class="nx">arguments</span><span class="p">.</span><span class="nx">length</span><span class="o">&gt;</span><span class="mi">0</span><span class="p">){</span><span class="nx">n</span><span class="o">=</span><span class="nb">Number</span><span class="p">(</span><span class="nx">arguments</span><span class="p">[</span><span class="mi">1</span><span class="p">]);</span><span class="k">if</span><span class="p">(</span><span class="nx">n</span><span class="o">!==</span><span class="nx">n</span><span class="p">)</span><span class="nx">n</span><span class="o">=</span><span class="mi">0</span><span class="p">;</span><span class="k">else</span> <span class="k">if</span><span class="p">(</span><span class="nx">n</span><span class="o">!==</span><span class="mi">0</span><span class="o">&amp;&amp;</span><span class="nx">n</span><span class="o">!==</span><span class="p">(</span><span class="mi">1</span><span class="o">/</span><span class="mi">0</span><span class="p">)</span><span class="o">&amp;&amp;</span><span class="nx">n</span><span class="o">!==-</span><span class="p">(</span><span class="mi">1</span><span class="o">/</span><span class="mi">0</span><span class="p">))</span><span class="nx">n</span><span class="o">=</span><span class="p">(</span><span class="nx">n</span><span class="o">&gt;</span><span class="mi">0</span><span class="o">||-</span><span class="mi">1</span><span class="p">)</span><span class="o">*</span><span class="nb">Math</span><span class="p">.</span><span class="nx">floor</span><span class="p">(</span><span class="nb">Math</span><span class="p">.</span><span class="nx">abs</span><span class="p">(</span><span class="nx">n</span><span class="p">))}</span><span class="k">if</span><span class="p">(</span><span class="nx">n</span><span class="o">&gt;=</span><span class="nx">len</span><span class="p">)</span><span class="k">return</span><span class="o">-</span><span class="mi">1</span><span class="p">;</span><span class="kd">var</span> <span class="nx">k</span><span class="o">=</span><span class="nx">n</span><span class="o">&gt;=</span><span class="mi">0</span><span class="o">?</span><span class="nx">n</span><span class="o">:</span><span class="nb">Math</span><span class="p">.</span><span class="nx">max</span><span class="p">(</span><span class="nx">len</span><span class="o">-</span><span class="nb">Math</span><span class="p">.</span><span class="nx">abs</span><span class="p">(</span><span class="nx">n</span><span class="p">),</span><span class="mi">0</span><span class="p">);</span><span class="k">for</span><span class="p">(;</span><span class="nx">k</span><span class="o">&lt;</span><span class="nx">len</span><span class="p">;</span><span class="nx">k</span><span class="o">++</span><span class="p">){</span><span class="k">if</span><span class="p">(</span><span class="nx">k</span> <span class="k">in</span> <span class="nx">t</span><span class="o">&amp;&amp;</span><span class="nx">t</span><span class="p">[</span><span class="nx">k</span><span class="p">]</span><span class="o">===</span><span class="nx">searchElement</span><span class="p">)</span><span class="k">return</span> <span class="nx">k</span><span class="p">}</span><span class="k">return</span><span class="o">-</span><span class="mi">1</span><span class="p">}}</span></pre></div>             </td>           </tr>                               <tr id="section-14">             <td class="docs">               <div class="pilwrap">                 <a class="pilcrow" href="#section-14">&#182;</a>               </div>               <p>https://developer.mozilla.org/en/Core<em>JavaScript</em>1.5<em>Reference:Global</em>Objects:Date</p>             </td>             <td class="code">               <div class="highlight"><pre><span class="kd">function</span> <span class="nx">ISODateString</span><span class="p">(</span><span class="nx">d</span><span class="p">){</span><span class="kd">function</span> <span class="nx">pad</span><span class="p">(</span><span class="nx">n</span><span class="p">){</span><span class="k">return</span> <span class="nx">n</span><span class="o">&lt;</span><span class="mi">10</span><span class="o">?</span><span class="s1">&#39;0&#39;</span><span class="o">+</span><span class="nx">n</span><span class="o">:</span><span class="nx">n</span><span class="p">}</span><span class="k">return</span> <span class="nx">d</span><span class="p">.</span><span class="nx">getUTCFullYear</span><span class="p">()</span><span class="o">+</span><span class="s1">&#39;-&#39;</span><span class="o">+</span><span class="nx">pad</span><span class="p">(</span><span class="nx">d</span><span class="p">.</span><span class="nx">getUTCMonth</span><span class="p">()</span><span class="o">+</span><span class="mi">1</span><span class="p">)</span><span class="o">+</span><span class="s1">&#39;-&#39;</span><span class="o">+</span><span class="nx">pad</span><span class="p">(</span><span class="nx">d</span><span class="p">.</span><span class="nx">getUTCDate</span><span class="p">())</span><span class="o">+</span><span class="s1">&#39;T&#39;</span><span class="o">+</span><span class="nx">pad</span><span class="p">(</span><span class="nx">d</span><span class="p">.</span><span class="nx">getUTCHours</span><span class="p">())</span><span class="o">+</span><span class="s1">&#39;:&#39;</span><span class="o">+</span><span class="nx">pad</span><span class="p">(</span><span class="nx">d</span><span class="p">.</span><span class="nx">getUTCMinutes</span><span class="p">())</span><span class="o">+</span><span class="s1">&#39;:&#39;</span><span class="o">+</span><span class="nx">pad</span><span class="p">(</span><span class="nx">d</span><span class="p">.</span><span class="nx">getUTCSeconds</span><span class="p">())</span><span class="o">+</span><span class="s1">&#39;Z&#39;</span><span class="p">}</span></pre></div>             </td>           </tr>                               <tr id="section-15">             <td class="docs">               <div class="pilwrap">                 <a class="pilcrow" href="#section-15">&#182;</a>               </div>               <p>JSON support for older browsers. Public domain.
https://github.com/douglascrockford/JSON-js/blob/master/json2.js</p>             </td>             <td class="code">               <div class="highlight"><pre><span class="kd">var</span> <span class="nx">JSON</span><span class="p">;</span><span class="nx">JSON</span><span class="o">||</span><span class="p">(</span><span class="nx">JSON</span><span class="o">=</span><span class="p">{}),</span><span class="kd">function</span><span class="p">(){</span><span class="kd">function</span> <span class="nx">f</span><span class="p">(</span><span class="nx">a</span><span class="p">){</span><span class="k">return</span> <span class="nx">a</span><span class="o">&lt;</span><span class="mi">10</span><span class="o">?</span><span class="s2">&quot;0&quot;</span><span class="o">+</span><span class="nx">a</span><span class="o">:</span><span class="nx">a</span><span class="p">}</span><span class="kd">function</span> <span class="nx">quote</span><span class="p">(</span><span class="nx">a</span><span class="p">){</span><span class="k">return</span> <span class="nx">escapable</span><span class="p">.</span><span class="nx">lastIndex</span><span class="o">=</span><span class="mi">0</span><span class="p">,</span><span class="nx">escapable</span><span class="p">.</span><span class="nx">test</span><span class="p">(</span><span class="nx">a</span><span class="p">)</span><span class="o">?</span><span class="s1">&#39;&quot;&#39;</span><span class="o">+</span><span class="nx">a</span><span class="p">.</span><span class="nx">replace</span><span class="p">(</span><span class="nx">escapable</span><span class="p">,</span><span class="kd">function</span><span class="p">(</span><span class="nx">a</span><span class="p">){</span><span class="kd">var</span> <span class="nx">b</span><span class="o">=</span><span class="nx">meta</span><span class="p">[</span><span class="nx">a</span><span class="p">];</span><span class="k">return</span> <span class="k">typeof</span> <span class="nx">b</span><span class="o">==</span><span class="s2">&quot;string&quot;</span><span class="o">?</span><span class="nx">b</span><span class="o">:</span><span class="s2">&quot;\\u&quot;</span><span class="o">+</span><span class="p">(</span><span class="s2">&quot;0000&quot;</span><span class="o">+</span><span class="nx">a</span><span class="p">.</span><span class="nx">charCodeAt</span><span class="p">(</span><span class="mi">0</span><span class="p">).</span><span class="nx">toString</span><span class="p">(</span><span class="mi">16</span><span class="p">)).</span><span class="nx">slice</span><span class="p">(</span><span class="o">-</span><span class="mi">4</span><span class="p">)})</span><span class="o">+</span><span class="s1">&#39;&quot;&#39;</span><span class="o">:</span><span class="s1">&#39;&quot;&#39;</span><span class="o">+</span><span class="nx">a</span><span class="o">+</span><span class="s1">&#39;&quot;&#39;</span><span class="p">}</span><span class="kd">function</span> <span class="nx">str</span><span class="p">(</span><span class="nx">a</span><span class="p">,</span><span class="nx">b</span><span class="p">){</span><span class="kd">var</span> <span class="nx">c</span><span class="p">,</span><span class="nx">d</span><span class="p">,</span><span class="nx">e</span><span class="p">,</span><span class="nx">f</span><span class="p">,</span><span class="nx">g</span><span class="o">=</span><span class="nx">gap</span><span class="p">,</span><span class="nx">h</span><span class="p">,</span><span class="nx">i</span><span class="o">=</span><span class="nx">b</span><span class="p">[</span><span class="nx">a</span><span class="p">];</span><span class="nx">i</span><span class="o">&amp;&amp;</span><span class="k">typeof</span> <span class="nx">i</span><span class="o">==</span><span class="s2">&quot;object&quot;</span><span class="o">&amp;&amp;</span><span class="k">typeof</span> <span class="nx">i</span><span class="p">.</span><span class="nx">toJSON</span><span class="o">==</span><span class="s2">&quot;function&quot;</span><span class="o">&amp;&amp;</span><span class="p">(</span><span class="nx">i</span><span class="o">=</span><span class="nx">i</span><span class="p">.</span><span class="nx">toJSON</span><span class="p">(</span><span class="nx">a</span><span class="p">)),</span><span class="k">typeof</span> <span class="nx">rep</span><span class="o">==</span><span class="s2">&quot;function&quot;</span><span class="o">&amp;&amp;</span><span class="p">(</span><span class="nx">i</span><span class="o">=</span><span class="nx">rep</span><span class="p">.</span><span class="nx">call</span><span class="p">(</span><span class="nx">b</span><span class="p">,</span><span class="nx">a</span><span class="p">,</span><span class="nx">i</span><span class="p">));</span><span class="k">switch</span><span class="p">(</span><span class="k">typeof</span> <span class="nx">i</span><span class="p">){</span><span class="k">case</span><span class="s2">&quot;string&quot;</span><span class="o">:</span><span class="k">return</span> <span class="nx">quote</span><span class="p">(</span><span class="nx">i</span><span class="p">);</span><span class="k">case</span><span class="s2">&quot;number&quot;</span><span class="o">:</span><span class="k">return</span> <span class="nb">isFinite</span><span class="p">(</span><span class="nx">i</span><span class="p">)</span><span class="o">?</span><span class="nb">String</span><span class="p">(</span><span class="nx">i</span><span class="p">)</span><span class="o">:</span><span class="s2">&quot;null&quot;</span><span class="p">;</span><span class="k">case</span><span class="s2">&quot;boolean&quot;</span><span class="o">:</span><span class="k">case</span><span class="s2">&quot;null&quot;</span><span class="o">:</span><span class="k">return</span> <span class="nb">String</span><span class="p">(</span><span class="nx">i</span><span class="p">);</span><span class="k">case</span><span class="s2">&quot;object&quot;</span><span class="o">:</span><span class="k">if</span><span class="p">(</span><span class="o">!</span><span class="nx">i</span><span class="p">)</span><span class="k">return</span><span class="s2">&quot;null&quot;</span><span class="p">;</span><span class="nx">gap</span><span class="o">+=</span><span class="nx">indent</span><span class="p">,</span><span class="nx">h</span><span class="o">=</span><span class="p">[];</span><span class="k">if</span><span class="p">(</span><span class="nb">Object</span><span class="p">.</span><span class="nx">prototype</span><span class="p">.</span><span class="nx">toString</span><span class="p">.</span><span class="nx">apply</span><span class="p">(</span><span class="nx">i</span><span class="p">)</span><span class="o">===</span><span class="s2">&quot;[object Array]&quot;</span><span class="p">){</span><span class="nx">f</span><span class="o">=</span><span class="nx">i</span><span class="p">.</span><span class="nx">length</span><span class="p">;</span><span class="k">for</span><span class="p">(</span><span class="nx">c</span><span class="o">=</span><span class="mi">0</span><span class="p">;</span><span class="nx">c</span><span class="o">&lt;</span><span class="nx">f</span><span class="p">;</span><span class="nx">c</span><span class="o">+=</span><span class="mi">1</span><span class="p">)</span><span class="nx">h</span><span class="p">[</span><span class="nx">c</span><span class="p">]</span><span class="o">=</span><span class="nx">str</span><span class="p">(</span><span class="nx">c</span><span class="p">,</span><span class="nx">i</span><span class="p">)</span><span class="o">||</span><span class="s2">&quot;null&quot;</span><span class="p">;</span><span class="k">return</span> <span class="nx">e</span><span class="o">=</span><span class="nx">h</span><span class="p">.</span><span class="nx">length</span><span class="o">===</span><span class="mi">0</span><span class="o">?</span><span class="s2">&quot;[]&quot;</span><span class="o">:</span><span class="nx">gap</span><span class="o">?</span><span class="s2">&quot;[\n&quot;</span><span class="o">+</span><span class="nx">gap</span><span class="o">+</span><span class="nx">h</span><span class="p">.</span><span class="nx">join</span><span class="p">(</span><span class="s2">&quot;,\n&quot;</span><span class="o">+</span><span class="nx">gap</span><span class="p">)</span><span class="o">+</span><span class="s2">&quot;\n&quot;</span><span class="o">+</span><span class="nx">g</span><span class="o">+</span><span class="s2">&quot;]&quot;</span><span class="o">:</span><span class="s2">&quot;[&quot;</span><span class="o">+</span><span class="nx">h</span><span class="p">.</span><span class="nx">join</span><span class="p">(</span><span class="s2">&quot;,&quot;</span><span class="p">)</span><span class="o">+</span><span class="s2">&quot;]&quot;</span><span class="p">,</span><span class="nx">gap</span><span class="o">=</span><span class="nx">g</span><span class="p">,</span><span class="nx">e</span><span class="p">}</span><span class="k">if</span><span class="p">(</span><span class="nx">rep</span><span class="o">&amp;&amp;</span><span class="k">typeof</span> <span class="nx">rep</span><span class="o">==</span><span class="s2">&quot;object&quot;</span><span class="p">){</span><span class="nx">f</span><span class="o">=</span><span class="nx">rep</span><span class="p">.</span><span class="nx">length</span><span class="p">;</span><span class="k">for</span><span class="p">(</span><span class="nx">c</span><span class="o">=</span><span class="mi">0</span><span class="p">;</span><span class="nx">c</span><span class="o">&lt;</span><span class="nx">f</span><span class="p">;</span><span class="nx">c</span><span class="o">+=</span><span class="mi">1</span><span class="p">)</span><span class="k">typeof</span> <span class="nx">rep</span><span class="p">[</span><span class="nx">c</span><span class="p">]</span><span class="o">==</span><span class="s2">&quot;string&quot;</span><span class="o">&amp;&amp;</span><span class="p">(</span><span class="nx">d</span><span class="o">=</span><span class="nx">rep</span><span class="p">[</span><span class="nx">c</span><span class="p">],</span><span class="nx">e</span><span class="o">=</span><span class="nx">str</span><span class="p">(</span><span class="nx">d</span><span class="p">,</span><span class="nx">i</span><span class="p">),</span><span class="nx">e</span><span class="o">&amp;&amp;</span><span class="nx">h</span><span class="p">.</span><span class="nx">push</span><span class="p">(</span><span class="nx">quote</span><span class="p">(</span><span class="nx">d</span><span class="p">)</span><span class="o">+</span><span class="p">(</span><span class="nx">gap</span><span class="o">?</span><span class="s2">&quot;: &quot;</span><span class="o">:</span><span class="s2">&quot;:&quot;</span><span class="p">)</span><span class="o">+</span><span class="nx">e</span><span class="p">))}</span><span class="k">else</span> <span class="k">for</span><span class="p">(</span><span class="nx">d</span> <span class="k">in</span> <span class="nx">i</span><span class="p">)</span><span class="nb">Object</span><span class="p">.</span><span class="nx">prototype</span><span class="p">.</span><span class="nx">hasOwnProperty</span><span class="p">.</span><span class="nx">call</span><span class="p">(</span><span class="nx">i</span><span class="p">,</span><span class="nx">d</span><span class="p">)</span><span class="o">&amp;&amp;</span><span class="p">(</span><span class="nx">e</span><span class="o">=</span><span class="nx">str</span><span class="p">(</span><span class="nx">d</span><span class="p">,</span><span class="nx">i</span><span class="p">),</span><span class="nx">e</span><span class="o">&amp;&amp;</span><span class="nx">h</span><span class="p">.</span><span class="nx">push</span><span class="p">(</span><span class="nx">quote</span><span class="p">(</span><span class="nx">d</span><span class="p">)</span><span class="o">+</span><span class="p">(</span><span class="nx">gap</span><span class="o">?</span><span class="s2">&quot;: &quot;</span><span class="o">:</span><span class="s2">&quot;:&quot;</span><span class="p">)</span><span class="o">+</span><span class="nx">e</span><span class="p">));</span><span class="k">return</span> <span class="nx">e</span><span class="o">=</span><span class="nx">h</span><span class="p">.</span><span class="nx">length</span><span class="o">===</span><span class="mi">0</span><span class="o">?</span><span class="s2">&quot;{}&quot;</span><span class="o">:</span><span class="nx">gap</span><span class="o">?</span><span class="s2">&quot;{\n&quot;</span><span class="o">+</span><span class="nx">gap</span><span class="o">+</span><span class="nx">h</span><span class="p">.</span><span class="nx">join</span><span class="p">(</span><span class="s2">&quot;,\n&quot;</span><span class="o">+</span><span class="nx">gap</span><span class="p">)</span><span class="o">+</span><span class="s2">&quot;\n&quot;</span><span class="o">+</span><span class="nx">g</span><span class="o">+</span><span class="s2">&quot;}&quot;</span><span class="o">:</span><span class="s2">&quot;{&quot;</span><span class="o">+</span><span class="nx">h</span><span class="p">.</span><span class="nx">join</span><span class="p">(</span><span class="s2">&quot;,&quot;</span><span class="p">)</span><span class="o">+</span><span class="s2">&quot;}&quot;</span><span class="p">,</span><span class="nx">gap</span><span class="o">=</span><span class="nx">g</span><span class="p">,</span><span class="nx">e</span><span class="p">}}</span><span class="s2">&quot;use strict&quot;</span><span class="p">,</span><span class="k">typeof</span> <span class="nb">Date</span><span class="p">.</span><span class="nx">prototype</span><span class="p">.</span><span class="nx">toJSON</span><span class="o">!=</span><span class="s2">&quot;function&quot;</span><span class="o">&amp;&amp;</span><span class="p">(</span><span class="nb">Date</span><span class="p">.</span><span class="nx">prototype</span><span class="p">.</span><span class="nx">toJSON</span><span class="o">=</span><span class="kd">function</span><span class="p">(</span><span class="nx">a</span><span class="p">){</span><span class="k">return</span> <span class="nb">isFinite</span><span class="p">(</span><span class="k">this</span><span class="p">.</span><span class="nx">valueOf</span><span class="p">())</span><span class="o">?</span><span class="k">this</span><span class="p">.</span><span class="nx">getUTCFullYear</span><span class="p">()</span><span class="o">+</span><span class="s2">&quot;-&quot;</span><span class="o">+</span><span class="nx">f</span><span class="p">(</span><span class="k">this</span><span class="p">.</span><span class="nx">getUTCMonth</span><span class="p">()</span><span class="o">+</span><span class="mi">1</span><span class="p">)</span><span class="o">+</span><span class="s2">&quot;-&quot;</span><span class="o">+</span><span class="nx">f</span><span class="p">(</span><span class="k">this</span><span class="p">.</span><span class="nx">getUTCDate</span><span class="p">())</span><span class="o">+</span><span class="s2">&quot;T&quot;</span><span class="o">+</span><span class="nx">f</span><span class="p">(</span><span class="k">this</span><span class="p">.</span><span class="nx">getUTCHours</span><span class="p">())</span><span class="o">+</span><span class="s2">&quot;:&quot;</span><span class="o">+</span><span class="nx">f</span><span class="p">(</span><span class="k">this</span><span class="p">.</span><span class="nx">getUTCMinutes</span><span class="p">())</span><span class="o">+</span><span class="s2">&quot;:&quot;</span><span class="o">+</span><span class="nx">f</span><span class="p">(</span><span class="k">this</span><span class="p">.</span><span class="nx">getUTCSeconds</span><span class="p">())</span><span class="o">+</span><span class="s2">&quot;Z&quot;</span><span class="o">:</span><span class="kc">null</span><span class="p">},</span><span class="nb">String</span><span class="p">.</span><span class="nx">prototype</span><span class="p">.</span><span class="nx">toJSON</span><span class="o">=</span><span class="nb">Number</span><span class="p">.</span><span class="nx">prototype</span><span class="p">.</span><span class="nx">toJSON</span><span class="o">=</span><span class="nb">Boolean</span><span class="p">.</span><span class="nx">prototype</span><span class="p">.</span><span class="nx">toJSON</span><span class="o">=</span><span class="kd">function</span><span class="p">(</span><span class="nx">a</span><span class="p">){</span><span class="k">return</span> <span class="k">this</span><span class="p">.</span><span class="nx">valueOf</span><span class="p">()});</span><span class="kd">var</span> <span class="nx">cx</span><span class="o">=</span><span class="sr">/[\u0000\u00ad\u0600-\u0604\u070f\u17b4\u17b5\u200c-\u200f\u2028-\u202f\u2060-\u206f\ufeff\ufff0-\uffff]/g</span><span class="p">,</span><span class="nx">escapable</span><span class="o">=</span><span class="sr">/[\\\&quot;\x00-\x1f\x7f-\x9f\u00ad\u0600-\u0604\u070f\u17b4\u17b5\u200c-\u200f\u2028-\u202f\u2060-\u206f\ufeff\ufff0-\uffff]/g</span><span class="p">,</span><span class="nx">gap</span><span class="p">,</span><span class="nx">indent</span><span class="p">,</span><span class="nx">meta</span><span class="o">=</span><span class="p">{</span><span class="s2">&quot;\b&quot;</span><span class="o">:</span><span class="s2">&quot;\\b&quot;</span><span class="p">,</span><span class="s2">&quot;\t&quot;</span><span class="o">:</span><span class="s2">&quot;\\t&quot;</span><span class="p">,</span><span class="s2">&quot;\n&quot;</span><span class="o">:</span><span class="s2">&quot;\\n&quot;</span><span class="p">,</span><span class="s2">&quot;\f&quot;</span><span class="o">:</span><span class="s2">&quot;\\f&quot;</span><span class="p">,</span><span class="s2">&quot;\r&quot;</span><span class="o">:</span><span class="s2">&quot;\\r&quot;</span><span class="p">,</span><span class="s1">&#39;&quot;&#39;</span><span class="o">:</span><span class="s1">&#39;\\&quot;&#39;</span><span class="p">,</span><span class="s2">&quot;\\&quot;</span><span class="o">:</span><span class="s2">&quot;\\\\&quot;</span><span class="p">},</span><span class="nx">rep</span><span class="p">;</span><span class="k">typeof</span> <span class="nx">JSON</span><span class="p">.</span><span class="nx">stringify</span><span class="o">!=</span><span class="s2">&quot;function&quot;</span><span class="o">&amp;&amp;</span><span class="p">(</span><span class="nx">JSON</span><span class="p">.</span><span class="nx">stringify</span><span class="o">=</span><span class="kd">function</span><span class="p">(</span><span class="nx">a</span><span class="p">,</span><span class="nx">b</span><span class="p">,</span><span class="nx">c</span><span class="p">){</span><span class="kd">var</span> <span class="nx">d</span><span class="p">;</span><span class="nx">gap</span><span class="o">=</span><span class="s2">&quot;&quot;</span><span class="p">,</span><span class="nx">indent</span><span class="o">=</span><span class="s2">&quot;&quot;</span><span class="p">;</span><span class="k">if</span><span class="p">(</span><span class="k">typeof</span> <span class="nx">c</span><span class="o">==</span><span class="s2">&quot;number&quot;</span><span class="p">)</span><span class="k">for</span><span class="p">(</span><span class="nx">d</span><span class="o">=</span><span class="mi">0</span><span class="p">;</span><span class="nx">d</span><span class="o">&lt;</span><span class="nx">c</span><span class="p">;</span><span class="nx">d</span><span class="o">+=</span><span class="mi">1</span><span class="p">)</span><span class="nx">indent</span><span class="o">+=</span><span class="s2">&quot; &quot;</span><span class="p">;</span><span class="k">else</span> <span class="k">typeof</span> <span class="nx">c</span><span class="o">==</span><span class="s2">&quot;string&quot;</span><span class="o">&amp;&amp;</span><span class="p">(</span><span class="nx">indent</span><span class="o">=</span><span class="nx">c</span><span class="p">);</span><span class="nx">rep</span><span class="o">=</span><span class="nx">b</span><span class="p">;</span><span class="k">if</span><span class="p">(</span><span class="o">!</span><span class="nx">b</span><span class="o">||</span><span class="k">typeof</span> <span class="nx">b</span><span class="o">==</span><span class="s2">&quot;function&quot;</span><span class="o">||</span><span class="k">typeof</span> <span class="nx">b</span><span class="o">==</span><span class="s2">&quot;object&quot;</span><span class="o">&amp;&amp;</span><span class="k">typeof</span> <span class="nx">b</span><span class="p">.</span><span class="nx">length</span><span class="o">==</span><span class="s2">&quot;number&quot;</span><span class="p">)</span><span class="k">return</span> <span class="nx">str</span><span class="p">(</span><span class="s2">&quot;&quot;</span><span class="p">,{</span><span class="s2">&quot;&quot;</span><span class="o">:</span><span class="nx">a</span><span class="p">});</span><span class="k">throw</span> <span class="k">new</span> <span class="nb">Error</span><span class="p">(</span><span class="s2">&quot;JSON.stringify&quot;</span><span class="p">)}),</span><span class="k">typeof</span> <span class="nx">JSON</span><span class="p">.</span><span class="nx">parse</span><span class="o">!=</span><span class="s2">&quot;function&quot;</span><span class="o">&amp;&amp;</span><span class="p">(</span><span class="nx">JSON</span><span class="p">.</span><span class="nx">parse</span><span class="o">=</span><span class="kd">function</span><span class="p">(</span><span class="nx">text</span><span class="p">,</span><span class="nx">reviver</span><span class="p">){</span><span class="kd">function</span> <span class="nx">walk</span><span class="p">(</span><span class="nx">a</span><span class="p">,</span><span class="nx">b</span><span class="p">){</span><span class="kd">var</span> <span class="nx">c</span><span class="p">,</span><span class="nx">d</span><span class="p">,</span><span class="nx">e</span><span class="o">=</span><span class="nx">a</span><span class="p">[</span><span class="nx">b</span><span class="p">];</span><span class="k">if</span><span class="p">(</span><span class="nx">e</span><span class="o">&amp;&amp;</span><span class="k">typeof</span> <span class="nx">e</span><span class="o">==</span><span class="s2">&quot;object&quot;</span><span class="p">)</span><span class="k">for</span><span class="p">(</span><span class="nx">c</span> <span class="k">in</span> <span class="nx">e</span><span class="p">)</span><span class="nb">Object</span><span class="p">.</span><span class="nx">prototype</span><span class="p">.</span><span class="nx">hasOwnProperty</span><span class="p">.</span><span class="nx">call</span><span class="p">(</span><span class="nx">e</span><span class="p">,</span><span class="nx">c</span><span class="p">)</span><span class="o">&amp;&amp;</span><span class="p">(</span><span class="nx">d</span><span class="o">=</span><span class="nx">walk</span><span class="p">(</span><span class="nx">e</span><span class="p">,</span><span class="nx">c</span><span class="p">),</span><span class="nx">d</span><span class="o">!==</span><span class="kc">undefined</span><span class="o">?</span><span class="nx">e</span><span class="p">[</span><span class="nx">c</span><span class="p">]</span><span class="o">=</span><span class="nx">d</span><span class="o">:</span><span class="k">delete</span> <span class="nx">e</span><span class="p">[</span><span class="nx">c</span><span class="p">]);</span><span class="k">return</span> <span class="nx">reviver</span><span class="p">.</span><span class="nx">call</span><span class="p">(</span><span class="nx">a</span><span class="p">,</span><span class="nx">b</span><span class="p">,</span><span class="nx">e</span><span class="p">)}</span><span class="kd">var</span> <span class="nx">j</span><span class="p">;</span><span class="nx">text</span><span class="o">=</span><span class="nb">String</span><span class="p">(</span><span class="nx">text</span><span class="p">),</span><span class="nx">cx</span><span class="p">.</span><span class="nx">lastIndex</span><span class="o">=</span><span class="mi">0</span><span class="p">,</span><span class="nx">cx</span><span class="p">.</span><span class="nx">test</span><span class="p">(</span><span class="nx">text</span><span class="p">)</span><span class="o">&amp;&amp;</span><span class="p">(</span><span class="nx">text</span><span class="o">=</span><span class="nx">text</span><span class="p">.</span><span class="nx">replace</span><span class="p">(</span><span class="nx">cx</span><span class="p">,</span><span class="kd">function</span><span class="p">(</span><span class="nx">a</span><span class="p">){</span><span class="k">return</span><span class="s2">&quot;\\u&quot;</span><span class="o">+</span><span class="p">(</span><span class="s2">&quot;0000&quot;</span><span class="o">+</span><span class="nx">a</span><span class="p">.</span><span class="nx">charCodeAt</span><span class="p">(</span><span class="mi">0</span><span class="p">).</span><span class="nx">toString</span><span class="p">(</span><span class="mi">16</span><span class="p">)).</span><span class="nx">slice</span><span class="p">(</span><span class="o">-</span><span class="mi">4</span><span class="p">)}));</span><span class="k">if</span><span class="p">(</span><span class="sr">/^[\],:{}\s]*$/</span><span class="p">.</span><span class="nx">test</span><span class="p">(</span><span class="nx">text</span><span class="p">.</span><span class="nx">replace</span><span class="p">(</span><span class="sr">/\\(?:[&quot;\\\/bfnrt]|u[0-9a-fA-F]{4})/g</span><span class="p">,</span><span class="s2">&quot;@&quot;</span><span class="p">).</span><span class="nx">replace</span><span class="p">(</span><span class="sr">/&quot;[^&quot;\\\n\r]*&quot;|true|false|null|-?\d+(?:\.\d*)?(?:[eE][+\-]?\d+)?/g</span><span class="p">,</span><span class="s2">&quot;]&quot;</span><span class="p">).</span><span class="nx">replace</span><span class="p">(</span><span class="sr">/(?:^|:|,)(?:\s*\[)+/g</span><span class="p">,</span><span class="s2">&quot;&quot;</span><span class="p">)))</span><span class="k">return</span> <span class="nx">j</span><span class="o">=</span><span class="nb">eval</span><span class="p">(</span><span class="s2">&quot;(&quot;</span><span class="o">+</span><span class="nx">text</span><span class="o">+</span><span class="s2">&quot;)&quot;</span><span class="p">),</span><span class="k">typeof</span> <span class="nx">reviver</span><span class="o">==</span><span class="s2">&quot;function&quot;</span><span class="o">?</span><span class="nx">walk</span><span class="p">({</span><span class="s2">&quot;&quot;</span><span class="o">:</span><span class="nx">j</span><span class="p">},</span><span class="s2">&quot;&quot;</span><span class="p">)</span><span class="o">:</span><span class="nx">j</span><span class="p">;</span><span class="k">throw</span> <span class="k">new</span> <span class="nx">SyntaxError</span><span class="p">(</span><span class="s2">&quot;JSON.parse&quot;</span><span class="p">)})}()</span></pre></div>             </td>           </tr>                               <tr id="section-16">             <td class="docs">               <div class="pilwrap">                 <a class="pilcrow" href="#section-16">&#182;</a>               </div>               <p>Universal stack trace method. Public domain.
https://raw.github.com/eriwen/javascript-stacktrace/master/stacktrace.js</p>             </td>             <td class="code">               <div class="highlight"><pre><span class="kd">function</span> <span class="nx">printStackTrace</span><span class="p">(</span><span class="nx">a</span><span class="p">){</span><span class="nx">a</span><span class="o">=</span><span class="nx">a</span><span class="o">||</span><span class="p">{</span><span class="nx">guess</span><span class="o">:!</span><span class="mi">0</span><span class="p">};</span><span class="kd">var</span> <span class="nx">b</span><span class="o">=</span><span class="nx">a</span><span class="p">.</span><span class="nx">e</span><span class="o">||</span><span class="kc">null</span><span class="p">,</span><span class="nx">c</span><span class="o">=!!</span><span class="nx">a</span><span class="p">.</span><span class="nx">guess</span><span class="p">,</span><span class="nx">d</span><span class="o">=</span><span class="k">new</span> <span class="nx">printStackTrace</span><span class="p">.</span><span class="nx">implementation</span><span class="p">,</span><span class="nx">e</span><span class="o">=</span><span class="nx">d</span><span class="p">.</span><span class="nx">run</span><span class="p">(</span><span class="nx">b</span><span class="p">);</span><span class="k">return</span> <span class="nx">c</span><span class="o">?</span><span class="nx">d</span><span class="p">.</span><span class="nx">guessAnonymousFunctions</span><span class="p">(</span><span class="nx">e</span><span class="p">)</span><span class="o">:</span><span class="nx">e</span><span class="p">}</span><span class="nx">printStackTrace</span><span class="p">.</span><span class="nx">implementation</span><span class="o">=</span><span class="kd">function</span><span class="p">(){},</span><span class="nx">printStackTrace</span><span class="p">.</span><span class="nx">implementation</span><span class="p">.</span><span class="nx">prototype</span><span class="o">=</span><span class="p">{</span><span class="nx">run</span><span class="o">:</span><span class="kd">function</span><span class="p">(</span><span class="nx">a</span><span class="p">,</span><span class="nx">b</span><span class="p">){</span><span class="k">return</span> <span class="nx">a</span><span class="o">=</span><span class="nx">a</span><span class="o">||</span><span class="k">this</span><span class="p">.</span><span class="nx">createException</span><span class="p">(),</span><span class="nx">b</span><span class="o">=</span><span class="nx">b</span><span class="o">||</span><span class="k">this</span><span class="p">.</span><span class="nx">mode</span><span class="p">(</span><span class="nx">a</span><span class="p">),</span><span class="nx">b</span><span class="o">===</span><span class="s2">&quot;other&quot;</span><span class="o">?</span><span class="k">this</span><span class="p">.</span><span class="nx">other</span><span class="p">(</span><span class="nx">arguments</span><span class="p">.</span><span class="nx">callee</span><span class="p">)</span><span class="o">:</span><span class="k">this</span><span class="p">[</span><span class="nx">b</span><span class="p">](</span><span class="nx">a</span><span class="p">)},</span><span class="nx">createException</span><span class="o">:</span><span class="kd">function</span><span class="p">(){</span><span class="k">try</span><span class="p">{</span><span class="k">this</span><span class="p">.</span><span class="nx">undef</span><span class="p">()}</span><span class="k">catch</span><span class="p">(</span><span class="nx">a</span><span class="p">){</span><span class="k">return</span> <span class="nx">a</span><span class="p">}},</span><span class="nx">mode</span><span class="o">:</span><span class="kd">function</span><span class="p">(</span><span class="nx">a</span><span class="p">){</span><span class="k">return</span> <span class="nx">a</span><span class="p">.</span><span class="nx">arguments</span><span class="o">&amp;&amp;</span><span class="nx">a</span><span class="p">.</span><span class="nx">stack</span><span class="o">?</span><span class="s2">&quot;chrome&quot;</span><span class="o">:</span><span class="k">typeof</span> <span class="nx">a</span><span class="p">.</span><span class="nx">message</span><span class="o">==</span><span class="s2">&quot;string&quot;</span><span class="o">&amp;&amp;</span><span class="k">typeof</span> <span class="nb">window</span><span class="o">!=</span><span class="s2">&quot;undefined&quot;</span><span class="o">&amp;&amp;</span><span class="nb">window</span><span class="p">.</span><span class="nx">opera</span><span class="o">?</span><span class="nx">a</span><span class="p">.</span><span class="nx">stacktrace</span><span class="o">?</span><span class="nx">a</span><span class="p">.</span><span class="nx">message</span><span class="p">.</span><span class="nx">indexOf</span><span class="p">(</span><span class="s2">&quot;\n&quot;</span><span class="p">)</span><span class="o">&gt;-</span><span class="mi">1</span><span class="o">&amp;&amp;</span><span class="nx">a</span><span class="p">.</span><span class="nx">message</span><span class="p">.</span><span class="nx">split</span><span class="p">(</span><span class="s2">&quot;\n&quot;</span><span class="p">).</span><span class="nx">length</span><span class="o">&gt;</span><span class="nx">a</span><span class="p">.</span><span class="nx">stacktrace</span><span class="p">.</span><span class="nx">split</span><span class="p">(</span><span class="s2">&quot;\n&quot;</span><span class="p">).</span><span class="nx">length</span><span class="o">?</span><span class="s2">&quot;opera9&quot;</span><span class="o">:</span><span class="nx">a</span><span class="p">.</span><span class="nx">stack</span><span class="o">?</span><span class="nx">a</span><span class="p">.</span><span class="nx">stacktrace</span><span class="p">.</span><span class="nx">indexOf</span><span class="p">(</span><span class="s2">&quot;called from line&quot;</span><span class="p">)</span><span class="o">&lt;</span><span class="mi">0</span><span class="o">?</span><span class="s2">&quot;opera10b&quot;</span><span class="o">:</span><span class="s2">&quot;opera11&quot;</span><span class="o">:</span><span class="s2">&quot;opera10a&quot;</span><span class="o">:</span><span class="s2">&quot;opera9&quot;</span><span class="o">:</span><span class="nx">a</span><span class="p">.</span><span class="nx">stack</span><span class="o">?</span><span class="s2">&quot;firefox&quot;</span><span class="o">:</span><span class="s2">&quot;other&quot;</span><span class="p">},</span><span class="nx">instrumentFunction</span><span class="o">:</span><span class="kd">function</span><span class="p">(</span><span class="nx">a</span><span class="p">,</span><span class="nx">b</span><span class="p">,</span><span class="nx">c</span><span class="p">){</span><span class="nx">a</span><span class="o">=</span><span class="nx">a</span><span class="o">||</span><span class="nb">window</span><span class="p">;</span><span class="kd">var</span> <span class="nx">d</span><span class="o">=</span><span class="nx">a</span><span class="p">[</span><span class="nx">b</span><span class="p">];</span><span class="nx">a</span><span class="p">[</span><span class="nx">b</span><span class="p">]</span><span class="o">=</span><span class="kd">function</span><span class="p">(){</span><span class="k">return</span> <span class="nx">c</span><span class="p">.</span><span class="nx">call</span><span class="p">(</span><span class="k">this</span><span class="p">,</span><span class="nx">printStackTrace</span><span class="p">().</span><span class="nx">slice</span><span class="p">(</span><span class="mi">4</span><span class="p">)),</span><span class="nx">a</span><span class="p">[</span><span class="nx">b</span><span class="p">].</span><span class="nx">_instrumented</span><span class="p">.</span><span class="nx">apply</span><span class="p">(</span><span class="k">this</span><span class="p">,</span><span class="nx">arguments</span><span class="p">)},</span><span class="nx">a</span><span class="p">[</span><span class="nx">b</span><span class="p">].</span><span class="nx">_instrumented</span><span class="o">=</span><span class="nx">d</span><span class="p">},</span><span class="nx">deinstrumentFunction</span><span class="o">:</span><span class="kd">function</span><span class="p">(</span><span class="nx">a</span><span class="p">,</span><span class="nx">b</span><span class="p">){</span><span class="nx">a</span><span class="p">[</span><span class="nx">b</span><span class="p">].</span><span class="nx">constructor</span><span class="o">===</span><span class="nb">Function</span><span class="o">&amp;&amp;</span><span class="nx">a</span><span class="p">[</span><span class="nx">b</span><span class="p">].</span><span class="nx">_instrumented</span><span class="o">&amp;&amp;</span><span class="nx">a</span><span class="p">[</span><span class="nx">b</span><span class="p">].</span><span class="nx">_instrumented</span><span class="p">.</span><span class="nx">constructor</span><span class="o">===</span><span class="nb">Function</span><span class="o">&amp;&amp;</span><span class="p">(</span><span class="nx">a</span><span class="p">[</span><span class="nx">b</span><span class="p">]</span><span class="o">=</span><span class="nx">a</span><span class="p">[</span><span class="nx">b</span><span class="p">].</span><span class="nx">_instrumented</span><span class="p">)},</span><span class="nx">chrome</span><span class="o">:</span><span class="kd">function</span><span class="p">(</span><span class="nx">a</span><span class="p">){</span><span class="kd">var</span> <span class="nx">b</span><span class="o">=</span><span class="p">(</span><span class="nx">a</span><span class="p">.</span><span class="nx">stack</span><span class="o">+</span><span class="s2">&quot;\n&quot;</span><span class="p">).</span><span class="nx">replace</span><span class="p">(</span><span class="sr">/^\S[^\(]+?[\n$]/gm</span><span class="p">,</span><span class="s2">&quot;&quot;</span><span class="p">).</span><span class="nx">replace</span><span class="p">(</span><span class="sr">/^\s+(at eval )?at\s+/gm</span><span class="p">,</span><span class="s2">&quot;&quot;</span><span class="p">).</span><span class="nx">replace</span><span class="p">(</span><span class="sr">/^([^\(]+?)([\n$])/gm</span><span class="p">,</span><span class="s2">&quot;{anonymous}()@$1$2&quot;</span><span class="p">).</span><span class="nx">replace</span><span class="p">(</span><span class="sr">/^Object.&lt;anonymous&gt;\s*\(([^\)]+)\)/gm</span><span class="p">,</span><span class="s2">&quot;{anonymous}()@$1&quot;</span><span class="p">).</span><span class="nx">split</span><span class="p">(</span><span class="s2">&quot;\n&quot;</span><span class="p">);</span><span class="k">return</span> <span class="nx">b</span><span class="p">.</span><span class="nx">pop</span><span class="p">(),</span><span class="nx">b</span><span class="p">},</span><span class="nx">firefox</span><span class="o">:</span><span class="kd">function</span><span class="p">(</span><span class="nx">a</span><span class="p">){</span><span class="k">return</span> <span class="nx">a</span><span class="p">.</span><span class="nx">stack</span><span class="p">.</span><span class="nx">replace</span><span class="p">(</span><span class="sr">/(?:\n@:0)?\s+$/m</span><span class="p">,</span><span class="s2">&quot;&quot;</span><span class="p">).</span><span class="nx">replace</span><span class="p">(</span><span class="sr">/^\(/gm</span><span class="p">,</span><span class="s2">&quot;{anonymous}(&quot;</span><span class="p">).</span><span class="nx">split</span><span class="p">(</span><span class="s2">&quot;\n&quot;</span><span class="p">)},</span><span class="nx">opera11</span><span class="o">:</span><span class="kd">function</span><span class="p">(</span><span class="nx">a</span><span class="p">){</span><span class="kd">var</span> <span class="nx">b</span><span class="o">=</span><span class="s2">&quot;{anonymous}&quot;</span><span class="p">,</span><span class="nx">c</span><span class="o">=</span><span class="sr">/^.*line (\d+), column (\d+)(?: in (.+))? in (\S+):$/</span><span class="p">,</span><span class="nx">d</span><span class="o">=</span><span class="nx">a</span><span class="p">.</span><span class="nx">stacktrace</span><span class="p">.</span><span class="nx">split</span><span class="p">(</span><span class="s2">&quot;\n&quot;</span><span class="p">),</span><span class="nx">e</span><span class="o">=</span><span class="p">[];</span><span class="k">for</span><span class="p">(</span><span class="kd">var</span> <span class="nx">f</span><span class="o">=</span><span class="mi">0</span><span class="p">,</span><span class="nx">g</span><span class="o">=</span><span class="nx">d</span><span class="p">.</span><span class="nx">length</span><span class="p">;</span><span class="nx">f</span><span class="o">&lt;</span><span class="nx">g</span><span class="p">;</span><span class="nx">f</span><span class="o">+=</span><span class="mi">2</span><span class="p">){</span><span class="kd">var</span> <span class="nx">h</span><span class="o">=</span><span class="nx">c</span><span class="p">.</span><span class="nx">exec</span><span class="p">(</span><span class="nx">d</span><span class="p">[</span><span class="nx">f</span><span class="p">]);</span><span class="k">if</span><span class="p">(</span><span class="nx">h</span><span class="p">){</span><span class="kd">var</span> <span class="nx">i</span><span class="o">=</span><span class="nx">h</span><span class="p">[</span><span class="mi">4</span><span class="p">]</span><span class="o">+</span><span class="s2">&quot;:&quot;</span><span class="o">+</span><span class="nx">h</span><span class="p">[</span><span class="mi">1</span><span class="p">]</span><span class="o">+</span><span class="s2">&quot;:&quot;</span><span class="o">+</span><span class="nx">h</span><span class="p">[</span><span class="mi">2</span><span class="p">],</span><span class="nx">j</span><span class="o">=</span><span class="nx">h</span><span class="p">[</span><span class="mi">3</span><span class="p">]</span><span class="o">||</span><span class="s2">&quot;global code&quot;</span><span class="p">;</span><span class="nx">j</span><span class="o">=</span><span class="nx">j</span><span class="p">.</span><span class="nx">replace</span><span class="p">(</span><span class="sr">/&lt;anonymous function: (\S+)&gt;/</span><span class="p">,</span><span class="s2">&quot;$1&quot;</span><span class="p">).</span><span class="nx">replace</span><span class="p">(</span><span class="sr">/&lt;anonymous function&gt;/</span><span class="p">,</span><span class="nx">b</span><span class="p">),</span><span class="nx">e</span><span class="p">.</span><span class="nx">push</span><span class="p">(</span><span class="nx">j</span><span class="o">+</span><span class="s2">&quot;@&quot;</span><span class="o">+</span><span class="nx">i</span><span class="o">+</span><span class="s2">&quot; -- &quot;</span><span class="o">+</span><span class="nx">d</span><span class="p">[</span><span class="nx">f</span><span class="o">+</span><span class="mi">1</span><span class="p">].</span><span class="nx">replace</span><span class="p">(</span><span class="sr">/^\s+/</span><span class="p">,</span><span class="s2">&quot;&quot;</span><span class="p">))}}</span><span class="k">return</span> <span class="nx">e</span><span class="p">},</span><span class="nx">opera10b</span><span class="o">:</span><span class="kd">function</span><span class="p">(</span><span class="nx">a</span><span class="p">){</span><span class="kd">var</span> <span class="nx">b</span><span class="o">=</span><span class="s2">&quot;{anonymous}&quot;</span><span class="p">,</span><span class="nx">c</span><span class="o">=</span><span class="sr">/^(.*)@(.+):(\d+)$/</span><span class="p">,</span><span class="nx">d</span><span class="o">=</span><span class="nx">a</span><span class="p">.</span><span class="nx">stacktrace</span><span class="p">.</span><span class="nx">split</span><span class="p">(</span><span class="s2">&quot;\n&quot;</span><span class="p">),</span><span class="nx">e</span><span class="o">=</span><span class="p">[];</span><span class="k">for</span><span class="p">(</span><span class="kd">var</span> <span class="nx">f</span><span class="o">=</span><span class="mi">0</span><span class="p">,</span><span class="nx">g</span><span class="o">=</span><span class="nx">d</span><span class="p">.</span><span class="nx">length</span><span class="p">;</span><span class="nx">f</span><span class="o">&lt;</span><span class="nx">g</span><span class="p">;</span><span class="nx">f</span><span class="o">++</span><span class="p">){</span><span class="kd">var</span> <span class="nx">h</span><span class="o">=</span><span class="nx">c</span><span class="p">.</span><span class="nx">exec</span><span class="p">(</span><span class="nx">d</span><span class="p">[</span><span class="nx">f</span><span class="p">]);</span><span class="k">if</span><span class="p">(</span><span class="nx">h</span><span class="p">){</span><span class="kd">var</span> <span class="nx">i</span><span class="o">=</span><span class="nx">h</span><span class="p">[</span><span class="mi">1</span><span class="p">]</span><span class="o">?</span><span class="nx">h</span><span class="p">[</span><span class="mi">1</span><span class="p">]</span><span class="o">+</span><span class="s2">&quot;()&quot;</span><span class="o">:</span><span class="s2">&quot;global code&quot;</span><span class="p">;</span><span class="nx">e</span><span class="p">.</span><span class="nx">push</span><span class="p">(</span><span class="nx">i</span><span class="o">+</span><span class="s2">&quot;@&quot;</span><span class="o">+</span><span class="nx">h</span><span class="p">[</span><span class="mi">2</span><span class="p">]</span><span class="o">+</span><span class="s2">&quot;:&quot;</span><span class="o">+</span><span class="nx">h</span><span class="p">[</span><span class="mi">3</span><span class="p">])}}</span><span class="k">return</span> <span class="nx">e</span><span class="p">},</span><span class="nx">opera10a</span><span class="o">:</span><span class="kd">function</span><span class="p">(</span><span class="nx">a</span><span class="p">){</span><span class="kd">var</span> <span class="nx">b</span><span class="o">=</span><span class="s2">&quot;{anonymous}&quot;</span><span class="p">,</span><span class="nx">c</span><span class="o">=</span><span class="sr">/Line (\d+).*script (?:in )?(\S+)(?:: In function (\S+))?$/i</span><span class="p">,</span><span class="nx">d</span><span class="o">=</span><span class="nx">a</span><span class="p">.</span><span class="nx">stacktrace</span><span class="p">.</span><span class="nx">split</span><span class="p">(</span><span class="s2">&quot;\n&quot;</span><span class="p">),</span><span class="nx">e</span><span class="o">=</span><span class="p">[];</span><span class="k">for</span><span class="p">(</span><span class="kd">var</span> <span class="nx">f</span><span class="o">=</span><span class="mi">0</span><span class="p">,</span><span class="nx">g</span><span class="o">=</span><span class="nx">d</span><span class="p">.</span><span class="nx">length</span><span class="p">;</span><span class="nx">f</span><span class="o">&lt;</span><span class="nx">g</span><span class="p">;</span><span class="nx">f</span><span class="o">+=</span><span class="mi">2</span><span class="p">){</span><span class="kd">var</span> <span class="nx">h</span><span class="o">=</span><span class="nx">c</span><span class="p">.</span><span class="nx">exec</span><span class="p">(</span><span class="nx">d</span><span class="p">[</span><span class="nx">f</span><span class="p">]);</span><span class="k">if</span><span class="p">(</span><span class="nx">h</span><span class="p">){</span><span class="kd">var</span> <span class="nx">i</span><span class="o">=</span><span class="nx">h</span><span class="p">[</span><span class="mi">3</span><span class="p">]</span><span class="o">||</span><span class="nx">b</span><span class="p">;</span><span class="nx">e</span><span class="p">.</span><span class="nx">push</span><span class="p">(</span><span class="nx">i</span><span class="o">+</span><span class="s2">&quot;()@&quot;</span><span class="o">+</span><span class="nx">h</span><span class="p">[</span><span class="mi">2</span><span class="p">]</span><span class="o">+</span><span class="s2">&quot;:&quot;</span><span class="o">+</span><span class="nx">h</span><span class="p">[</span><span class="mi">1</span><span class="p">]</span><span class="o">+</span><span class="s2">&quot; -- &quot;</span><span class="o">+</span><span class="nx">d</span><span class="p">[</span><span class="nx">f</span><span class="o">+</span><span class="mi">1</span><span class="p">].</span><span class="nx">replace</span><span class="p">(</span><span class="sr">/^\s+/</span><span class="p">,</span><span class="s2">&quot;&quot;</span><span class="p">))}}</span><span class="k">return</span> <span class="nx">e</span><span class="p">},</span><span class="nx">opera9</span><span class="o">:</span><span class="kd">function</span><span class="p">(</span><span class="nx">a</span><span class="p">){</span><span class="kd">var</span> <span class="nx">b</span><span class="o">=</span><span class="s2">&quot;{anonymous}&quot;</span><span class="p">,</span><span class="nx">c</span><span class="o">=</span><span class="sr">/Line (\d+).*script (?:in )?(\S+)/i</span><span class="p">,</span><span class="nx">d</span><span class="o">=</span><span class="nx">a</span><span class="p">.</span><span class="nx">message</span><span class="p">.</span><span class="nx">split</span><span class="p">(</span><span class="s2">&quot;\n&quot;</span><span class="p">),</span><span class="nx">e</span><span class="o">=</span><span class="p">[];</span><span class="k">for</span><span class="p">(</span><span class="kd">var</span> <span class="nx">f</span><span class="o">=</span><span class="mi">2</span><span class="p">,</span><span class="nx">g</span><span class="o">=</span><span class="nx">d</span><span class="p">.</span><span class="nx">length</span><span class="p">;</span><span class="nx">f</span><span class="o">&lt;</span><span class="nx">g</span><span class="p">;</span><span class="nx">f</span><span class="o">+=</span><span class="mi">2</span><span class="p">){</span><span class="kd">var</span> <span class="nx">h</span><span class="o">=</span><span class="nx">c</span><span class="p">.</span><span class="nx">exec</span><span class="p">(</span><span class="nx">d</span><span class="p">[</span><span class="nx">f</span><span class="p">]);</span><span class="nx">h</span><span class="o">&amp;&amp;</span><span class="nx">e</span><span class="p">.</span><span class="nx">push</span><span class="p">(</span><span class="nx">b</span><span class="o">+</span><span class="s2">&quot;()@&quot;</span><span class="o">+</span><span class="nx">h</span><span class="p">[</span><span class="mi">2</span><span class="p">]</span><span class="o">+</span><span class="s2">&quot;:&quot;</span><span class="o">+</span><span class="nx">h</span><span class="p">[</span><span class="mi">1</span><span class="p">]</span><span class="o">+</span><span class="s2">&quot; -- &quot;</span><span class="o">+</span><span class="nx">d</span><span class="p">[</span><span class="nx">f</span><span class="o">+</span><span class="mi">1</span><span class="p">].</span><span class="nx">replace</span><span class="p">(</span><span class="sr">/^\s+/</span><span class="p">,</span><span class="s2">&quot;&quot;</span><span class="p">))}</span><span class="k">return</span> <span class="nx">e</span><span class="p">},</span><span class="nx">other</span><span class="o">:</span><span class="kd">function</span><span class="p">(</span><span class="nx">a</span><span class="p">){</span><span class="kd">var</span> <span class="nx">b</span><span class="o">=</span><span class="s2">&quot;{anonymous}&quot;</span><span class="p">,</span><span class="nx">c</span><span class="o">=</span><span class="sr">/function\s*([\w\-$]+)?\s*\(/i</span><span class="p">,</span><span class="nx">d</span><span class="o">=</span><span class="p">[],</span><span class="nx">e</span><span class="p">,</span><span class="nx">f</span><span class="p">,</span><span class="nx">g</span><span class="o">=</span><span class="mi">10</span><span class="p">;</span><span class="k">while</span><span class="p">(</span><span class="nx">a</span><span class="o">&amp;&amp;</span><span class="nx">a</span><span class="p">.</span><span class="nx">arguments</span><span class="o">&amp;&amp;</span><span class="nx">d</span><span class="p">.</span><span class="nx">length</span><span class="o">&lt;</span><span class="nx">g</span><span class="p">)</span><span class="nx">e</span><span class="o">=</span><span class="nx">c</span><span class="p">.</span><span class="nx">test</span><span class="p">(</span><span class="nx">a</span><span class="p">.</span><span class="nx">toString</span><span class="p">())</span><span class="o">?</span><span class="nb">RegExp</span><span class="p">.</span><span class="nx">$1</span><span class="o">||</span><span class="nx">b</span><span class="o">:</span><span class="nx">b</span><span class="p">,</span><span class="nx">f</span><span class="o">=</span><span class="nb">Array</span><span class="p">.</span><span class="nx">prototype</span><span class="p">.</span><span class="nx">slice</span><span class="p">.</span><span class="nx">call</span><span class="p">(</span><span class="nx">a</span><span class="p">.</span><span class="nx">arguments</span><span class="o">||</span><span class="p">[]),</span><span class="nx">d</span><span class="p">[</span><span class="nx">d</span><span class="p">.</span><span class="nx">length</span><span class="p">]</span><span class="o">=</span><span class="nx">e</span><span class="o">+</span><span class="s2">&quot;(&quot;</span><span class="o">+</span><span class="k">this</span><span class="p">.</span><span class="nx">stringifyArguments</span><span class="p">(</span><span class="nx">f</span><span class="p">)</span><span class="o">+</span><span class="s2">&quot;)&quot;</span><span class="p">,</span><span class="nx">a</span><span class="o">=</span><span class="nx">a</span><span class="p">.</span><span class="nx">caller</span><span class="p">;</span><span class="k">return</span> <span class="nx">d</span><span class="p">},</span><span class="nx">stringifyArguments</span><span class="o">:</span><span class="kd">function</span><span class="p">(</span><span class="nx">a</span><span class="p">){</span><span class="kd">var</span> <span class="nx">b</span><span class="o">=</span><span class="p">[],</span><span class="nx">c</span><span class="o">=</span><span class="nb">Array</span><span class="p">.</span><span class="nx">prototype</span><span class="p">.</span><span class="nx">slice</span><span class="p">;</span><span class="k">for</span><span class="p">(</span><span class="kd">var</span> <span class="nx">d</span><span class="o">=</span><span class="mi">0</span><span class="p">;</span><span class="nx">d</span><span class="o">&lt;</span><span class="nx">a</span><span class="p">.</span><span class="nx">length</span><span class="p">;</span><span class="o">++</span><span class="nx">d</span><span class="p">){</span><span class="kd">var</span> <span class="nx">e</span><span class="o">=</span><span class="nx">a</span><span class="p">[</span><span class="nx">d</span><span class="p">];</span><span class="nx">e</span><span class="o">===</span><span class="kc">undefined</span><span class="o">?</span><span class="nx">b</span><span class="p">[</span><span class="nx">d</span><span class="p">]</span><span class="o">=</span><span class="s2">&quot;undefined&quot;</span><span class="o">:</span><span class="nx">e</span><span class="o">===</span><span class="kc">null</span><span class="o">?</span><span class="nx">b</span><span class="p">[</span><span class="nx">d</span><span class="p">]</span><span class="o">=</span><span class="s2">&quot;null&quot;</span><span class="o">:</span><span class="nx">e</span><span class="p">.</span><span class="nx">constructor</span><span class="o">&amp;&amp;</span><span class="p">(</span><span class="nx">e</span><span class="p">.</span><span class="nx">constructor</span><span class="o">===</span><span class="nb">Array</span><span class="o">?</span><span class="nx">e</span><span class="p">.</span><span class="nx">length</span><span class="o">&lt;</span><span class="mi">3</span><span class="o">?</span><span class="nx">b</span><span class="p">[</span><span class="nx">d</span><span class="p">]</span><span class="o">=</span><span class="s2">&quot;[&quot;</span><span class="o">+</span><span class="k">this</span><span class="p">.</span><span class="nx">stringifyArguments</span><span class="p">(</span><span class="nx">e</span><span class="p">)</span><span class="o">+</span><span class="s2">&quot;]&quot;</span><span class="o">:</span><span class="nx">b</span><span class="p">[</span><span class="nx">d</span><span class="p">]</span><span class="o">=</span><span class="s2">&quot;[&quot;</span><span class="o">+</span><span class="k">this</span><span class="p">.</span><span class="nx">stringifyArguments</span><span class="p">(</span><span class="nx">c</span><span class="p">.</span><span class="nx">call</span><span class="p">(</span><span class="nx">e</span><span class="p">,</span><span class="mi">0</span><span class="p">,</span><span class="mi">1</span><span class="p">))</span><span class="o">+</span><span class="s2">&quot;...&quot;</span><span class="o">+</span><span class="k">this</span><span class="p">.</span><span class="nx">stringifyArguments</span><span class="p">(</span><span class="nx">c</span><span class="p">.</span><span class="nx">call</span><span class="p">(</span><span class="nx">e</span><span class="p">,</span><span class="o">-</span><span class="mi">1</span><span class="p">))</span><span class="o">+</span><span class="s2">&quot;]&quot;</span><span class="o">:</span><span class="nx">e</span><span class="p">.</span><span class="nx">constructor</span><span class="o">===</span><span class="nb">Object</span><span class="o">?</span><span class="nx">b</span><span class="p">[</span><span class="nx">d</span><span class="p">]</span><span class="o">=</span><span class="s2">&quot;#object&quot;</span><span class="o">:</span><span class="nx">e</span><span class="p">.</span><span class="nx">constructor</span><span class="o">===</span><span class="nb">Function</span><span class="o">?</span><span class="nx">b</span><span class="p">[</span><span class="nx">d</span><span class="p">]</span><span class="o">=</span><span class="s2">&quot;#function&quot;</span><span class="o">:</span><span class="nx">e</span><span class="p">.</span><span class="nx">constructor</span><span class="o">===</span><span class="nb">String</span><span class="o">?</span><span class="nx">b</span><span class="p">[</span><span class="nx">d</span><span class="p">]</span><span class="o">=</span><span class="s1">&#39;&quot;&#39;</span><span class="o">+</span><span class="nx">e</span><span class="o">+</span><span class="s1">&#39;&quot;&#39;</span><span class="o">:</span><span class="nx">e</span><span class="p">.</span><span class="nx">constructor</span><span class="o">===</span><span class="nb">Number</span><span class="o">&amp;&amp;</span><span class="p">(</span><span class="nx">b</span><span class="p">[</span><span class="nx">d</span><span class="p">]</span><span class="o">=</span><span class="nx">e</span><span class="p">))}</span><span class="k">return</span> <span class="nx">b</span><span class="p">.</span><span class="nx">join</span><span class="p">(</span><span class="s2">&quot;,&quot;</span><span class="p">)},</span><span class="nx">sourceCache</span><span class="o">:</span><span class="p">{},</span><span class="nx">ajax</span><span class="o">:</span><span class="kd">function</span><span class="p">(</span><span class="nx">a</span><span class="p">){</span><span class="kd">var</span> <span class="nx">b</span><span class="o">=</span><span class="k">this</span><span class="p">.</span><span class="nx">createXMLHTTPObject</span><span class="p">();</span><span class="k">if</span><span class="p">(</span><span class="nx">b</span><span class="p">)</span><span class="k">try</span><span class="p">{</span><span class="k">return</span> <span class="nx">b</span><span class="p">.</span><span class="nx">open</span><span class="p">(</span><span class="s2">&quot;GET&quot;</span><span class="p">,</span><span class="nx">a</span><span class="p">,</span><span class="o">!</span><span class="mi">1</span><span class="p">),</span><span class="nx">b</span><span class="p">.</span><span class="nx">notify</span><span class="p">(</span><span class="kc">null</span><span class="p">),</span><span class="nx">b</span><span class="p">.</span><span class="nx">responseText</span><span class="p">}</span><span class="k">catch</span><span class="p">(</span><span class="nx">c</span><span class="p">){}</span><span class="k">return</span><span class="s2">&quot;&quot;</span><span class="p">},</span><span class="nx">createXMLHTTPObject</span><span class="o">:</span><span class="kd">function</span><span class="p">(){</span><span class="kd">var</span> <span class="nx">a</span><span class="p">,</span><span class="nx">b</span><span class="o">=</span><span class="p">[</span><span class="kd">function</span><span class="p">(){</span><span class="k">return</span> <span class="k">new</span> <span class="nx">XMLHttpRequest</span><span class="p">},</span><span class="kd">function</span><span class="p">(){</span><span class="k">return</span> <span class="k">new</span> <span class="nx">ActiveXObject</span><span class="p">(</span><span class="s2">&quot;Msxml2.XMLHTTP&quot;</span><span class="p">)},</span><span class="kd">function</span><span class="p">(){</span><span class="k">return</span> <span class="k">new</span> <span class="nx">ActiveXObject</span><span class="p">(</span><span class="s2">&quot;Msxml3.XMLHTTP&quot;</span><span class="p">)},</span><span class="kd">function</span><span class="p">(){</span><span class="k">return</span> <span class="k">new</span> <span class="nx">ActiveXObject</span><span class="p">(</span><span class="s2">&quot;Microsoft.XMLHTTP&quot;</span><span class="p">)}];</span><span class="k">for</span><span class="p">(</span><span class="kd">var</span> <span class="nx">c</span><span class="o">=</span><span class="mi">0</span><span class="p">;</span><span class="nx">c</span><span class="o">&lt;</span><span class="nx">b</span><span class="p">.</span><span class="nx">length</span><span class="p">;</span><span class="nx">c</span><span class="o">++</span><span class="p">)</span><span class="k">try</span><span class="p">{</span><span class="k">return</span> <span class="nx">a</span><span class="o">=</span><span class="nx">b</span><span class="p">[</span><span class="nx">c</span><span class="p">](),</span><span class="k">this</span><span class="p">.</span><span class="nx">createXMLHTTPObject</span><span class="o">=</span><span class="nx">b</span><span class="p">[</span><span class="nx">c</span><span class="p">],</span><span class="nx">a</span><span class="p">}</span><span class="k">catch</span><span class="p">(</span><span class="nx">d</span><span class="p">){}},</span><span class="nx">isSameDomain</span><span class="o">:</span><span class="kd">function</span><span class="p">(</span><span class="nx">a</span><span class="p">){</span><span class="k">return</span> <span class="nx">a</span><span class="p">.</span><span class="nx">indexOf</span><span class="p">(</span><span class="nx">location</span><span class="p">.</span><span class="nx">hostname</span><span class="p">)</span><span class="o">!==-</span><span class="mi">1</span><span class="p">},</span><span class="nx">getSource</span><span class="o">:</span><span class="kd">function</span><span class="p">(</span><span class="nx">a</span><span class="p">){</span><span class="k">return</span> <span class="nx">a</span> <span class="k">in</span> <span class="k">this</span><span class="p">.</span><span class="nx">sourceCache</span><span class="o">||</span><span class="p">(</span><span class="k">this</span><span class="p">.</span><span class="nx">sourceCache</span><span class="p">[</span><span class="nx">a</span><span class="p">]</span><span class="o">=</span><span class="k">this</span><span class="p">.</span><span class="nx">ajax</span><span class="p">(</span><span class="nx">a</span><span class="p">).</span><span class="nx">split</span><span class="p">(</span><span class="s2">&quot;\n&quot;</span><span class="p">)),</span><span class="k">this</span><span class="p">.</span><span class="nx">sourceCache</span><span class="p">[</span><span class="nx">a</span><span class="p">]},</span><span class="nx">guessAnonymousFunctions</span><span class="o">:</span><span class="kd">function</span><span class="p">(</span><span class="nx">a</span><span class="p">){</span><span class="k">for</span><span class="p">(</span><span class="kd">var</span> <span class="nx">b</span><span class="o">=</span><span class="mi">0</span><span class="p">;</span><span class="nx">b</span><span class="o">&lt;</span><span class="nx">a</span><span class="p">.</span><span class="nx">length</span><span class="p">;</span><span class="o">++</span><span class="nx">b</span><span class="p">){</span><span class="kd">var</span> <span class="nx">c</span><span class="o">=</span><span class="sr">/\{anonymous\}\(.*\)@(.*)/</span><span class="p">,</span><span class="nx">d</span><span class="o">=</span><span class="sr">/^(.*?)(?::(\d+))(?::(\d+))?(?: -- .+)?$/</span><span class="p">,</span><span class="nx">e</span><span class="o">=</span><span class="nx">a</span><span class="p">[</span><span class="nx">b</span><span class="p">],</span><span class="nx">f</span><span class="o">=</span><span class="nx">c</span><span class="p">.</span><span class="nx">exec</span><span class="p">(</span><span class="nx">e</span><span class="p">);</span><span class="k">if</span><span class="p">(</span><span class="nx">f</span><span class="p">){</span><span class="kd">var</span> <span class="nx">g</span><span class="o">=</span><span class="nx">d</span><span class="p">.</span><span class="nx">exec</span><span class="p">(</span><span class="nx">f</span><span class="p">[</span><span class="mi">1</span><span class="p">]);</span><span class="k">if</span><span class="p">(</span><span class="nx">g</span><span class="p">){</span><span class="kd">var</span> <span class="nx">h</span><span class="o">=</span><span class="nx">g</span><span class="p">[</span><span class="mi">1</span><span class="p">],</span><span class="nx">i</span><span class="o">=</span><span class="nx">g</span><span class="p">[</span><span class="mi">2</span><span class="p">],</span><span class="nx">j</span><span class="o">=</span><span class="nx">g</span><span class="p">[</span><span class="mi">3</span><span class="p">]</span><span class="o">||</span><span class="mi">0</span><span class="p">;</span><span class="k">if</span><span class="p">(</span><span class="nx">h</span><span class="o">&amp;&amp;</span><span class="k">this</span><span class="p">.</span><span class="nx">isSameDomain</span><span class="p">(</span><span class="nx">h</span><span class="p">)</span><span class="o">&amp;&amp;</span><span class="nx">i</span><span class="p">){</span><span class="kd">var</span> <span class="nx">k</span><span class="o">=</span><span class="k">this</span><span class="p">.</span><span class="nx">guessAnonymousFunction</span><span class="p">(</span><span class="nx">h</span><span class="p">,</span><span class="nx">i</span><span class="p">,</span><span class="nx">j</span><span class="p">);</span><span class="nx">a</span><span class="p">[</span><span class="nx">b</span><span class="p">]</span><span class="o">=</span><span class="nx">e</span><span class="p">.</span><span class="nx">replace</span><span class="p">(</span><span class="s2">&quot;{anonymous}&quot;</span><span class="p">,</span><span class="nx">k</span><span class="p">)}}}}</span><span class="k">return</span> <span class="nx">a</span><span class="p">},</span><span class="nx">guessAnonymousFunction</span><span class="o">:</span><span class="kd">function</span><span class="p">(</span><span class="nx">a</span><span class="p">,</span><span class="nx">b</span><span class="p">,</span><span class="nx">c</span><span class="p">){</span><span class="kd">var</span> <span class="nx">d</span><span class="p">;</span><span class="k">try</span><span class="p">{</span><span class="nx">d</span><span class="o">=</span><span class="k">this</span><span class="p">.</span><span class="nx">findFunctionName</span><span class="p">(</span><span class="k">this</span><span class="p">.</span><span class="nx">getSource</span><span class="p">(</span><span class="nx">a</span><span class="p">),</span><span class="nx">b</span><span class="p">)}</span><span class="k">catch</span><span class="p">(</span><span class="nx">e</span><span class="p">){</span><span class="nx">d</span><span class="o">=</span><span class="s2">&quot;getSource failed with url: &quot;</span><span class="o">+</span><span class="nx">a</span><span class="o">+</span><span class="s2">&quot;, exception: &quot;</span><span class="o">+</span><span class="nx">e</span><span class="p">.</span><span class="nx">toString</span><span class="p">()}</span><span class="k">return</span> <span class="nx">d</span><span class="p">},</span><span class="nx">findFunctionName</span><span class="o">:</span><span class="kd">function</span><span class="p">(</span><span class="nx">a</span><span class="p">,</span><span class="nx">b</span><span class="p">){</span><span class="kd">var</span> <span class="nx">c</span><span class="o">=</span><span class="sr">/function\s+([^(]*?)\s*\(([^)]*)\)/</span><span class="p">,</span><span class="nx">d</span><span class="o">=</span><span class="sr">/[&#39;&quot;]?([0-9A-Za-z_]+)[&#39;&quot;]?\s*[:=]\s*function\b/</span><span class="p">,</span><span class="nx">e</span><span class="o">=</span><span class="sr">/[&#39;&quot;]?([0-9A-Za-z_]+)[&#39;&quot;]?\s*[:=]\s*(?:eval|new Function)\b/</span><span class="p">,</span><span class="nx">f</span><span class="o">=</span><span class="s2">&quot;&quot;</span><span class="p">,</span><span class="nx">g</span><span class="p">,</span><span class="nx">h</span><span class="o">=</span><span class="nb">Math</span><span class="p">.</span><span class="nx">min</span><span class="p">(</span><span class="nx">b</span><span class="p">,</span><span class="mi">20</span><span class="p">),</span><span class="nx">i</span><span class="p">,</span><span class="nx">j</span><span class="p">;</span><span class="k">for</span><span class="p">(</span><span class="kd">var</span> <span class="nx">k</span><span class="o">=</span><span class="mi">0</span><span class="p">;</span><span class="nx">k</span><span class="o">&lt;</span><span class="nx">h</span><span class="p">;</span><span class="o">++</span><span class="nx">k</span><span class="p">){</span><span class="nx">g</span><span class="o">=</span><span class="nx">a</span><span class="p">[</span><span class="nx">b</span><span class="o">-</span><span class="nx">k</span><span class="o">-</span><span class="mi">1</span><span class="p">],</span><span class="nx">j</span><span class="o">=</span><span class="nx">g</span><span class="p">.</span><span class="nx">indexOf</span><span class="p">(</span><span class="s2">&quot;//&quot;</span><span class="p">),</span><span class="nx">j</span><span class="o">&gt;=</span><span class="mi">0</span><span class="o">&amp;&amp;</span><span class="p">(</span><span class="nx">g</span><span class="o">=</span><span class="nx">g</span><span class="p">.</span><span class="nx">substr</span><span class="p">(</span><span class="mi">0</span><span class="p">,</span><span class="nx">j</span><span class="p">));</span><span class="k">if</span><span class="p">(</span><span class="nx">g</span><span class="p">){</span><span class="nx">f</span><span class="o">=</span><span class="nx">g</span><span class="o">+</span><span class="nx">f</span><span class="p">,</span><span class="nx">i</span><span class="o">=</span><span class="nx">d</span><span class="p">.</span><span class="nx">exec</span><span class="p">(</span><span class="nx">f</span><span class="p">);</span><span class="k">if</span><span class="p">(</span><span class="nx">i</span><span class="o">&amp;&amp;</span><span class="nx">i</span><span class="p">[</span><span class="mi">1</span><span class="p">])</span><span class="k">return</span> <span class="nx">i</span><span class="p">[</span><span class="mi">1</span><span class="p">];</span><span class="nx">i</span><span class="o">=</span><span class="nx">c</span><span class="p">.</span><span class="nx">exec</span><span class="p">(</span><span class="nx">f</span><span class="p">);</span><span class="k">if</span><span class="p">(</span><span class="nx">i</span><span class="o">&amp;&amp;</span><span class="nx">i</span><span class="p">[</span><span class="mi">1</span><span class="p">])</span><span class="k">return</span> <span class="nx">i</span><span class="p">[</span><span class="mi">1</span><span class="p">];</span><span class="nx">i</span><span class="o">=</span><span class="nx">e</span><span class="p">.</span><span class="nx">exec</span><span class="p">(</span><span class="nx">f</span><span class="p">);</span><span class="k">if</span><span class="p">(</span><span class="nx">i</span><span class="o">&amp;&amp;</span><span class="nx">i</span><span class="p">[</span><span class="mi">1</span><span class="p">])</span><span class="k">return</span> <span class="nx">i</span><span class="p">[</span><span class="mi">1</span><span class="p">]}}</span><span class="k">return</span><span class="s2">&quot;(?)&quot;</span><span class="p">}}</span>

</pre></div>             </td>           </tr>                </tbody>     </table>   </div> </body> </html> 